<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>后台手册 | RuoYi</title>
    <meta name="generator" content="VuePress 1.8.3">
    <link rel="icon" href="/images/favicon.ico">
    <link rel="stylesheet" href="/css/ruoyi.css">
    <script charset="utf-8" src="/js/ruoyi.js"></script>
    <meta name="description" content="使用若依快速构建web应用程序">
    
    <link rel="preload" href="/assets/css/0.styles.d6ad21ed.css" as="style"><link rel="preload" href="/assets/js/app.c3abf7ee.js" as="script"><link rel="preload" href="/assets/js/2.f516d180.js" as="script"><link rel="preload" href="/assets/js/51.8c138180.js" as="script"><link rel="prefetch" href="/assets/js/10.731a4d43.js"><link rel="prefetch" href="/assets/js/11.528419ea.js"><link rel="prefetch" href="/assets/js/12.e7444f79.js"><link rel="prefetch" href="/assets/js/13.a395ede7.js"><link rel="prefetch" href="/assets/js/14.874b879c.js"><link rel="prefetch" href="/assets/js/15.474d0efa.js"><link rel="prefetch" href="/assets/js/16.501f0998.js"><link rel="prefetch" href="/assets/js/17.c9fd1b5b.js"><link rel="prefetch" href="/assets/js/18.840a1c4b.js"><link rel="prefetch" href="/assets/js/19.29b935c2.js"><link rel="prefetch" href="/assets/js/20.4f577393.js"><link rel="prefetch" href="/assets/js/21.8b85136f.js"><link rel="prefetch" href="/assets/js/22.678e089b.js"><link rel="prefetch" href="/assets/js/23.e608d9bf.js"><link rel="prefetch" href="/assets/js/24.3df80953.js"><link rel="prefetch" href="/assets/js/25.80bdd342.js"><link rel="prefetch" href="/assets/js/26.8a3b95a9.js"><link rel="prefetch" href="/assets/js/27.3eb61a11.js"><link rel="prefetch" href="/assets/js/28.4b1c6f97.js"><link rel="prefetch" href="/assets/js/29.a8b19b18.js"><link rel="prefetch" href="/assets/js/3.ca16bf72.js"><link rel="prefetch" href="/assets/js/30.a42979a6.js"><link rel="prefetch" href="/assets/js/31.379791f7.js"><link rel="prefetch" href="/assets/js/32.39b24193.js"><link rel="prefetch" href="/assets/js/33.444cf8e8.js"><link rel="prefetch" href="/assets/js/34.b55a1c88.js"><link rel="prefetch" href="/assets/js/35.fbcd2bb6.js"><link rel="prefetch" href="/assets/js/36.131461bf.js"><link rel="prefetch" href="/assets/js/37.319d0ad7.js"><link rel="prefetch" href="/assets/js/38.f0549b87.js"><link rel="prefetch" href="/assets/js/39.45a1dd30.js"><link rel="prefetch" href="/assets/js/4.c986860c.js"><link rel="prefetch" href="/assets/js/40.4aeafe89.js"><link rel="prefetch" href="/assets/js/41.34f2f0ac.js"><link rel="prefetch" href="/assets/js/42.a4fa56dc.js"><link rel="prefetch" href="/assets/js/43.c847d416.js"><link rel="prefetch" href="/assets/js/44.e54eadaa.js"><link rel="prefetch" href="/assets/js/45.4e39aa7c.js"><link rel="prefetch" href="/assets/js/46.728be48a.js"><link rel="prefetch" href="/assets/js/47.0964481e.js"><link rel="prefetch" href="/assets/js/48.4bf5de6e.js"><link rel="prefetch" href="/assets/js/49.c50a41bd.js"><link rel="prefetch" href="/assets/js/5.88ad39ea.js"><link rel="prefetch" href="/assets/js/50.68d2fdad.js"><link rel="prefetch" href="/assets/js/52.63209656.js"><link rel="prefetch" href="/assets/js/53.3c37058f.js"><link rel="prefetch" href="/assets/js/54.ead2f3aa.js"><link rel="prefetch" href="/assets/js/55.04038ace.js"><link rel="prefetch" href="/assets/js/56.9a50bae4.js"><link rel="prefetch" href="/assets/js/57.e8b2b4d0.js"><link rel="prefetch" href="/assets/js/58.8e2ac16b.js"><link rel="prefetch" href="/assets/js/59.3fb2e8d2.js"><link rel="prefetch" href="/assets/js/6.da8722b2.js"><link rel="prefetch" href="/assets/js/60.aae167a9.js"><link rel="prefetch" href="/assets/js/7.6075b05b.js"><link rel="prefetch" href="/assets/js/8.c6b3de51.js"><link rel="prefetch" href="/assets/js/9.b57aa4ca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d6ad21ed.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">RuoYi</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/ruoyi/" class="nav-link router-link-active">
  文档
</a></div><div class="nav-item"><a href="/ruoyi-vue/" class="nav-link">
  分离版
</a></div><div class="nav-item"><a href="/ruoyi-cloud/" class="nav-link">
  微服务版
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生态系统" class="dropdown-title"><span class="title">生态系统</span> <span class="arrow down"></span></button> <button type="button" aria-label="生态系统" class="mobile-dropdown-title"><span class="title">生态系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RuoYi
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi-Vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RuoYi-Vue
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi-Cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RuoYi-Cloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          扩展列表
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ruoyi/document/xmkz.html" class="nav-link">
  RuoYi 项目扩展
</a></li><li class="dropdown-subitem"><a href="/ruoyi-vue/document/xmkz.html" class="nav-link">
  RuoYi-Vue 项目扩展
</a></li><li class="dropdown-subitem"><a href="/ruoyi-cloud/document/xmkz.html" class="nav-link">
  RuoYi-Cloud 项目扩展
</a></li></ul></li><li class="dropdown-item"><h4>
          帮助
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我要提问
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/ruoyi/other/faq.html" class="nav-link">
  常见问题
</a></li><li class="dropdown-subitem"><a href="https://jq.qq.com/?_wv=1027&amp;k=1sNsfWzD" target="_blank" rel="noopener noreferrer" class="nav-link external">
  加入QQ群
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/yangzongzhuan/RuoYi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/y_project/RuoYi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/ruoyi/" class="nav-link router-link-active">
  文档
</a></div><div class="nav-item"><a href="/ruoyi-vue/" class="nav-link">
  分离版
</a></div><div class="nav-item"><a href="/ruoyi-cloud/" class="nav-link">
  微服务版
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生态系统" class="dropdown-title"><span class="title">生态系统</span> <span class="arrow down"></span></button> <button type="button" aria-label="生态系统" class="mobile-dropdown-title"><span class="title">生态系统</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          项目
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RuoYi
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi-Vue" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RuoYi-Vue
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi-Cloud" target="_blank" rel="noopener noreferrer" class="nav-link external">
  RuoYi-Cloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li><li class="dropdown-item"><h4>
          扩展列表
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ruoyi/document/xmkz.html" class="nav-link">
  RuoYi 项目扩展
</a></li><li class="dropdown-subitem"><a href="/ruoyi-vue/document/xmkz.html" class="nav-link">
  RuoYi-Vue 项目扩展
</a></li><li class="dropdown-subitem"><a href="/ruoyi-cloud/document/xmkz.html" class="nav-link">
  RuoYi-Cloud 项目扩展
</a></li></ul></li><li class="dropdown-item"><h4>
          帮助
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://gitee.com/y_project/RuoYi/issues" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我要提问
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="/ruoyi/other/faq.html" class="nav-link">
  常见问题
</a></li><li class="dropdown-subitem"><a href="https://jq.qq.com/?_wv=1027&amp;k=1sNsfWzD" target="_blank" rel="noopener noreferrer" class="nav-link external">
  加入QQ群
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/yangzongzhuan/RuoYi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://gitee.com/y_project/RuoYi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gitee
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ruoyi/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/ruoyi/document/kslj.html" class="sidebar-link">快速了解</a></li><li><a href="/ruoyi/document/hjbs.html" class="sidebar-link">环境部署</a></li><li><a href="/ruoyi/document/xmjs.html" class="sidebar-link">项目介绍</a></li><li><a href="/ruoyi/document/htsc.html" aria-current="page" class="active sidebar-link">后台手册</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#分页实现" class="sidebar-link">分页实现</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#前端调用实现" class="sidebar-link">前端调用实现</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#后台逻辑实现" class="sidebar-link">后台逻辑实现</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#导入导出" class="sidebar-link">导入导出</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#注解参数说明" class="sidebar-link">注解参数说明</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#导出实现流程" class="sidebar-link">导出实现流程</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#导入实现流程" class="sidebar-link">导入实现流程</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#自定义标题信息" class="sidebar-link">自定义标题信息</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#自定义数据处理器" class="sidebar-link">自定义数据处理器</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#上传下载" class="sidebar-link">上传下载</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#上传实现流程" class="sidebar-link">上传实现流程</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#下载实现流程" class="sidebar-link">下载实现流程</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#权限注解" class="sidebar-link">权限注解</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#requiresroles" class="sidebar-link">@RequiresRoles</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#requirespermissions" class="sidebar-link">@RequiresPermissions</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#事务管理" class="sidebar-link">事务管理</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#异常处理" class="sidebar-link">异常处理</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#参数验证" class="sidebar-link">参数验证</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#注解参数说明-2" class="sidebar-link">注解参数说明</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#数据校验使用" class="sidebar-link">数据校验使用</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#自定义注解校验" class="sidebar-link">自定义注解校验</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#自定义分组校验" class="sidebar-link">自定义分组校验</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#系统日志" class="sidebar-link">系统日志</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#注解参数说明-3" class="sidebar-link">注解参数说明</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#自定义操作功能" class="sidebar-link">自定义操作功能</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#数据权限" class="sidebar-link">数据权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#注解参数说明-4" class="sidebar-link">注解参数说明</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#数据权限使用" class="sidebar-link">数据权限使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#多数据源" class="sidebar-link">多数据源</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#注解参数说明-5" class="sidebar-link">注解参数说明</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#多数据源使用" class="sidebar-link">多数据源使用</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#手动切换数据源" class="sidebar-link">手动切换数据源</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#代码生成" class="sidebar-link">代码生成</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#默认配置" class="sidebar-link">默认配置</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#单表结构" class="sidebar-link">单表结构</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#树表结构" class="sidebar-link">树表结构</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#主子表结构" class="sidebar-link">主子表结构</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#代码生成使用" class="sidebar-link">代码生成使用</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#定时任务" class="sidebar-link">定时任务</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#系统接口" class="sidebar-link">系统接口</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#防重复提交" class="sidebar-link">防重复提交</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#国际化支持" class="sidebar-link">国际化支持</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#后台国际化流程" class="sidebar-link">后台国际化流程</a></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#前端国际化流程" class="sidebar-link">前端国际化流程</a></li></ul></li><li class="sidebar-sub-header"><a href="/ruoyi/document/htsc.html#新建子模块" class="sidebar-link">新建子模块</a></li></ul></li><li><a href="/ruoyi/document/qdsc.html" class="sidebar-link">前端手册</a></li><li><a href="/ruoyi/document/gnzj.html" class="sidebar-link">功能组件</a></li><li><a href="/ruoyi/document/mbyq.html" class="sidebar-link">模板引擎</a></li><li><a href="/ruoyi/document/zjwd.html" class="sidebar-link">组件文档</a></li><li><a href="/ruoyi/document/cjjc.html" class="sidebar-link">插件集成</a></li><li><a href="/ruoyi/document/xmkz.html" class="sidebar-link">项目扩展</a></li><li><a href="/ruoyi/document/spjc.html" class="sidebar-link">视频教程</a></li><li><a href="/ruoyi/document/gxrz.html" class="sidebar-link">更新日志</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其它</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ruoyi/other/faq.html" class="sidebar-link">常见问题</a></li><li><a href="/ruoyi/other/donate.html" class="sidebar-link">捐赠支持</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="后台手册"><a href="#后台手册" class="header-anchor">#</a> 后台手册</h1> <h2 id="分页实现"><a href="#分页实现" class="header-anchor">#</a> 分页实现</h2> <ul><li>前端采用基于<code>bootstrap</code>的轻量级表格插件<a href="https://github.com/wenzhixin/bootstrap-table" target="_blank" rel="noopener noreferrer">bootstrap-table<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>后端采用基于<code>mybatis</code>的轻量级分页插件<a href="https://github.com/pagehelper/Mybatis-PageHelper" target="_blank" rel="noopener noreferrer">pageHelper<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>前后端分页实现流程</p></div> <h3 id="前端调用实现"><a href="#前端调用实现" class="header-anchor">#</a> 前端调用实现</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">url</span><span class="token operator">:</span> prefix <span class="token operator">+</span> <span class="token string">&quot;/list&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'主键'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'名称'</span>
	<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
$<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>自定义查询条件参数（特殊情况提前设置查询条件下使用）</p></blockquote> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">url</span><span class="token operator">:</span> prefix <span class="token operator">+</span> <span class="token string">&quot;/list&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">queryParams</span><span class="token operator">:</span> queryParams<span class="token punctuation">,</span>
	<span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'主键'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'名称'</span>
	<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
$<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">queryParams</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> search <span class="token operator">=</span> $<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">queryParams</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span><span class="token punctuation">;</span>
	search<span class="token punctuation">.</span>userName <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#userName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> search<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="后台逻辑实现"><a href="#后台逻辑实现" class="header-anchor">#</a> 后台逻辑实现</h3> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/list&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">TableDataInfo</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token function">startPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 此方法配合前端完成自动分页</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token function">getDataTable</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>常见坑点1：<code>selectPostById</code>莫名其妙的分页。例如下面这段代码</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token function">startPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Post</span> post <span class="token operator">=</span> postService<span class="token punctuation">.</span><span class="token function">selectPostById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token function">getDataTable</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>原因分析：这种情况下由于<code>user</code>存在<code>null</code>的情况，就会导致<code>pageHelper</code>生产了一个分页参数，但是没有被消费，这个参数就会一直保留在这个线程上。
当这个线程再次被使用时，就可能导致不该分页的方法去消费这个分页参数，这就产生了莫名其妙的分页。<br>
上面这个代码，应该写成下面这个样子才能保证安全。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>user <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">startPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
	list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Post</span> post <span class="token operator">=</span> postService<span class="token punctuation">.</span><span class="token function">selectPostById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token function">getDataTable</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li>常见坑点2：添加了<code>startPage</code>方法。也没有正常分页。例如下面这段代码</li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token function">startPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Post</span> post <span class="token operator">=</span> postService<span class="token punctuation">.</span><span class="token function">selectPostById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token function">getDataTable</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>原因分析：只对该语句以后的第一个查询<code>（Select）</code>语句得到的数据进行分页。<br>
上面这个代码，应该写成下面这个样子才能正常分页。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Post</span> post <span class="token operator">=</span> postService<span class="token punctuation">.</span><span class="token function">selectPostById</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">startPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token function">getDataTable</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">注意</p> <p>如果改为其他数据库需修改配置<code>application.yml</code>文件中的属性<code>helperDialect=你的数据库</code></p></div> <h2 id="导入导出"><a href="#导入导出" class="header-anchor">#</a> 导入导出</h2> <p>在实际开发中经常需要使用导入导出功能来加快数据的操作。在项目中可以使用注解来完成此项功能。
在需要被导入导出的实体类属性添加<code>@Excel</code>注解，目前支持参数如下：</p> <h3 id="注解参数说明"><a href="#注解参数说明" class="header-anchor">#</a> 注解参数说明</h3> <table><thead><tr><th>参数</th> <th>类型</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>sort</td> <td>int</td> <td>Integer.MAX_VALUE</td> <td>导出时在excel中排序，值越小越靠前</td></tr> <tr><td>name</td> <td>String</td> <td>空</td> <td>导出到Excel中的名字</td></tr> <tr><td>dateFormat</td> <td>String</td> <td>空</td> <td>日期格式, 如: yyyy-MM-dd</td></tr> <tr><td>dictType</td> <td>String</td> <td>空</td> <td>如果是字典类型，请设置字典的type值 (如: sys_user_sex)</td></tr> <tr><td>readConverterExp</td> <td>String</td> <td>空</td> <td>读取内容转表达式 (如: 0=男,1=女,2=未知)</td></tr> <tr><td>separator</td> <td>String</td> <td>,</td> <td>分隔符，读取字符串组内容</td></tr> <tr><td>scale</td> <td>int</td> <td>-1</td> <td>BigDecimal 精度 默认:-1(默认不开启BigDecimal格式化)</td></tr> <tr><td>roundingMode</td> <td>int</td> <td>BigDecimal.ROUND_HALF_EVEN</td> <td>BigDecimal 舍入规则 默认:BigDecimal.ROUND_HALF_EVEN</td></tr> <tr><td>celltype</td> <td>Enum</td> <td>Type.STRING</td> <td>导出类型（0数字 1字符串 2图片）</td></tr> <tr><td>height</td> <td>String</td> <td>14</td> <td>导出时在excel中每个列的高度 单位为字符</td></tr> <tr><td>width</td> <td>String</td> <td>16</td> <td>导出时在excel中每个列的宽 单位为字符</td></tr> <tr><td>suffix</td> <td>String</td> <td>空</td> <td>文字后缀,如% 90 变成90%</td></tr> <tr><td>defaultValue</td> <td>String</td> <td>空</td> <td>当值为空时,字段的默认值</td></tr> <tr><td>prompt</td> <td>String</td> <td>空</td> <td>提示信息</td></tr> <tr><td>combo</td> <td>String</td> <td>Null</td> <td>设置只能选择不能输入的列内容</td></tr> <tr><td>color</td> <td>Enum</td> <td>IndexedColors.BLACK</td> <td>导出字体颜色IndexedColors.XXXX</td></tr> <tr><td>targetAttr</td> <td>String</td> <td>空</td> <td>另一个类中的属性名称,支持多级获取,以小数点隔开</td></tr> <tr><td>isStatistics</td> <td>boolean</td> <td>false</td> <td>是否自动统计数据,在最后追加一行统计数据总和</td></tr> <tr><td>type</td> <td>Enum</td> <td>Type.ALL</td> <td>字段类型（0：导出导入；1：仅导出；2：仅导入）</td></tr> <tr><td>align</td> <td>Enum</td> <td>HorizontalAlignment.CENTER</td> <td>导出对齐方式HorizontalAlignment.XXXX</td></tr> <tr><td>handler</td> <td>Class</td> <td>ExcelHandlerAdapter.class</td> <td>自定义数据处理器</td></tr> <tr><td>args</td> <td>String[]</td> <td>{}</td> <td>自定义数据处理器参数</td></tr></tbody></table> <h3 id="导出实现流程"><a href="#导出实现流程" class="header-anchor">#</a> 导出实现流程</h3> <p>1、前端调用封装好的方法<code>$.table.init</code>，传入后台<code>exportUrl</code></p> <div class="language-javascript line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-javascript"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">exportUrl</span><span class="token operator">:</span> prefix <span class="token operator">+</span> <span class="token string">&quot;/export&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'主键'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'名称'</span>
	<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
$<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>2、添加导出按钮事件</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-warning<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">$<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-download<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span> 导出
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3、在实体变量上添加<code>@Excel</code>注解</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户序号&quot;</span><span class="token punctuation">,</span> prompt <span class="token operator">=</span> <span class="token string">&quot;用户编号&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Long</span> userId<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户名称&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户性别&quot;</span><span class="token punctuation">,</span> readConverterExp <span class="token operator">=</span> <span class="token string">&quot;0=男,1=女,2=未知&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> sex<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户头像&quot;</span><span class="token punctuation">,</span> cellType <span class="token operator">=</span> <span class="token class-name">ColumnType</span><span class="token punctuation">.</span><span class="token constant">IMAGE</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> avatar<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;帐号状态&quot;</span><span class="token punctuation">,</span> dictType <span class="token operator">=</span> <span class="token string">&quot;sys_normal_disable&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> status<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;最后登陆时间&quot;</span><span class="token punctuation">,</span> width <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> dateFormat <span class="token operator">=</span> <span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Date</span> loginDate<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>4、在<code>Controller</code>添加导出方法</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/export&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">export</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> util <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> util<span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token string">&quot;用户数据&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>导出默认流程是先创建一个临时文件，等待前端请求下载结束后马上删除这个临时文件。如遇到迅雷这种二次请求下载应用可能会导致文件已经被删除，我们也可以改成流的形式返回给前端。
参考实现 - <a href="/ruoyi/other/faq.html#如何解决导出使用下载插件出现异常">如何解决导出使用下载插件出现异常</a></p></div> <h3 id="导入实现流程"><a href="#导入实现流程" class="header-anchor">#</a> 导入实现流程</h3> <p>1、前端调用封装好的方法<code>$.table.init</code>，传入后台<code>importUrl</code>。</p> <div class="language-javascript line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-javascript"><code><span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
	<span class="token literal-property property">importUrl</span><span class="token operator">:</span> prefix <span class="token operator">+</span> <span class="token string">&quot;/importData&quot;</span><span class="token punctuation">,</span>
	<span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'主键'</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token literal-property property">field</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'名称'</span>
	<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
$<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>2、添加导入按钮事件</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-info<span class="token punctuation">&quot;</span></span> <span class="token special-attr"><span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value javascript language-javascript">$<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">importExcel</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>i</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fa fa-upload<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>i</span><span class="token punctuation">&gt;</span></span> 导入
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>3、添加导入前端代码，<code>form</code>默认<code>id</code>为<code>importForm</code>，也可指定<code>importExcel(id)</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 导入区域 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>importTpl<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/template<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token operator">&lt;</span>form enctype<span class="token operator">=</span><span class="token string">&quot;multipart/form-data&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mt20 mb10&quot;</span><span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;col-xs-offset-1&quot;</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;file&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;file&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;mt10 pt5&quot;</span><span class="token operator">&gt;</span>
			<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span> id<span class="token operator">=</span><span class="token string">&quot;updateSupport&quot;</span> name<span class="token operator">=</span><span class="token string">&quot;updateSupport&quot;</span> title<span class="token operator">=</span><span class="token string">&quot;如果登录账户已经存在，更新这条数据。&quot;</span><span class="token operator">&gt;</span> 是否更新已经存在的用户数据
			 <span class="token operator">&amp;</span>nbsp<span class="token punctuation">;</span>	<span class="token operator">&lt;</span>a onclick<span class="token operator">=</span><span class="token string">&quot;$.table.importTemplate()&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;btn btn-default btn-xs&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>i <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;fa fa-file-excel-o&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>i<span class="token operator">&gt;</span> 下载模板<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
		<span class="token operator">&lt;</span>font color<span class="token operator">=</span><span class="token string">&quot;red&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;pull-left mt10&quot;</span><span class="token operator">&gt;</span>
			提示：仅允许导入“xls”或“xlsx”格式文件！
		<span class="token operator">&lt;</span><span class="token operator">/</span>font<span class="token operator">&gt;</span>
	<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>4、在实体变量上添加<code>@Excel</code>注解，默认为导出导入，也可以单独设置仅导入<code>Type.IMPORT</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户序号&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;部门编号&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">IMPORT</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Long</span> deptId<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户名称&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>

<span class="token comment">/** 导出部门多个对象 */</span>
<span class="token annotation punctuation">@Excels</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;部门名称&quot;</span><span class="token punctuation">,</span> targetAttr <span class="token operator">=</span> <span class="token string">&quot;deptName&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">EXPORT</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;部门负责人&quot;</span><span class="token punctuation">,</span> targetAttr <span class="token operator">=</span> <span class="token string">&quot;leader&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">EXPORT</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">SysDept</span> dept<span class="token punctuation">;</span>

<span class="token comment">/** 导出部门单个对象 */</span>
<span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;部门名称&quot;</span><span class="token punctuation">,</span> targetAttr <span class="token operator">=</span> <span class="token string">&quot;deptName&quot;</span><span class="token punctuation">,</span> type <span class="token operator">=</span> <span class="token class-name">Type</span><span class="token punctuation">.</span><span class="token constant">EXPORT</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">SysDept</span> dept<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>5、在<code>Controller</code>添加导入方法，<code>updateSupport</code>属性为是否存在则覆盖（可选）</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importData&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">importData</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token keyword">boolean</span> updateSupport<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> util <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">SysUser</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">importExcel</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> operName <span class="token operator">=</span> <span class="token class-name">ShiroUtils</span><span class="token punctuation">.</span><span class="token function">getSysUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLoginName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> message <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">importUser</span><span class="token punctuation">(</span>userList<span class="token punctuation">,</span> updateSupport<span class="token punctuation">,</span> operName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>也可以直接到main运行此方法测试。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">InputStream</span> is <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">&quot;D:\\test.xlsx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Entity</span><span class="token punctuation">&gt;</span></span> util <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Entity</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Entity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Entity</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">importExcel</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <h3 id="自定义标题信息"><a href="#自定义标题信息" class="header-anchor">#</a> 自定义标题信息</h3> <p>有时候我们希望导出表格包含标题信息，我们可以这样做。</p> <p><strong>导出用户管理表格新增标题（用户列表）</strong></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">export</span><span class="token punctuation">(</span><span class="token class-name">SysUser</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> util <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">SysUser</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> util<span class="token punctuation">.</span><span class="token function">exportExcel</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token string">&quot;用户数据&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;用户列表&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>导入表格包含标题处理方式，其中<code>1</code>表示标题占用行数，根据实际情况填写。</strong></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">importData</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token keyword">boolean</span> updateSupport<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> util <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelUtil</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">SysUser</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> util<span class="token punctuation">.</span><span class="token function">importExcel</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> operName <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">String</span> message <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">importUser</span><span class="token punctuation">(</span>userList<span class="token punctuation">,</span> updateSupport<span class="token punctuation">,</span> operName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="自定义数据处理器"><a href="#自定义数据处理器" class="header-anchor">#</a> 自定义数据处理器</h3> <p>有时候我们希望数据展现为一个特殊的格式，或者需要对数据进行其它处理。<code>Excel</code>注解提供了自定义数据处理器以满足各种业务场景。而实现一个数据处理器也是非常简单的。如下：</p> <p>1、在实体类用<code>Excel</code>注解<code>handler</code>属性指定自定义的数据处理器</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br></div><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span>
<span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Excel</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;用户名称&quot;</span><span class="token punctuation">,</span> handler <span class="token operator">=</span> <span class="token class-name">MyDataHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string">&quot;aaa&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bbb&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> userName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2、编写数据处理器<code>MyDataHandler</code>继承<code>ExcelHandlerAdapter</code>，返回值为处理后的值。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyDataHandler</span> <span class="token keyword">implements</span> <span class="token class-name">ExcelHandlerAdapter</span>
<span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// value 为单元格数据值</span>
		<span class="token comment">// args 为excel注解args参数组</span>
		<span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="上传下载"><a href="#上传下载" class="header-anchor">#</a> 上传下载</h2> <p>首先创建一张上传文件的表，例如：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> sys_file_info<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> sys_file_info <span class="token punctuation">(</span>
  file_id           <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>          <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span>       <span class="token keyword">comment</span> <span class="token string">'文件id'</span><span class="token punctuation">,</span>
  file_name         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>      <span class="token keyword">default</span> <span class="token string">''</span>                    <span class="token keyword">comment</span> <span class="token string">'文件名称'</span><span class="token punctuation">,</span>
  file_path         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>                    <span class="token keyword">comment</span> <span class="token string">'文件路径'</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>file_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span> <span class="token keyword">auto_increment</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">default</span> <span class="token keyword">charset</span><span class="token operator">=</span>utf8 <span class="token keyword">comment</span> <span class="token operator">=</span> <span class="token string">'文件信息表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="上传实现流程"><a href="#上传实现流程" class="header-anchor">#</a> 上传实现流程</h3> <p>1、代码生成<code>sys_file_info</code>表相关代码并复制到对应目录。</p> <p>2、参考示例修改代码。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filePath<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>filePath<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">submitHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>$<span class="token punctuation">.</span>validate<span class="token punctuation">.</span><span class="token function">form</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> formData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#filePath'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		$<span class="token punctuation">.</span>modal<span class="token punctuation">.</span><span class="token function">alertWarning</span><span class="token punctuation">(</span><span class="token string">&quot;请先选择文件路径&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'fileName'</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#fileName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	formData<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#filePath'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">url</span><span class="token operator">:</span> prefix <span class="token operator">+</span> <span class="token string">&quot;/add&quot;</span><span class="token punctuation">,</span>
		<span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'post'</span><span class="token punctuation">,</span>
		<span class="token literal-property property">cache</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
		<span class="token literal-property property">data</span><span class="token operator">:</span> formData<span class="token punctuation">,</span>
		<span class="token literal-property property">processData</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
		<span class="token literal-property property">contentType</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
		<span class="token literal-property property">dataType</span><span class="token operator">:</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span>
		<span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			$<span class="token punctuation">.</span>operate<span class="token punctuation">.</span><span class="token function">successCallback</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>3、在<code>FileInfoController</code>添加对应上传方法</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>	
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/add&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">addSave</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token class-name">FileInfo</span> fileInfo<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 上传文件路径</span>
	<span class="token class-name">String</span> filePath <span class="token operator">=</span> <span class="token class-name">RuoYiConfig</span><span class="token punctuation">.</span><span class="token function">getUploadPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 上传并返回新文件名称</span>
	<span class="token class-name">String</span> fileName <span class="token operator">=</span> <span class="token class-name">FileUploadUtils</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
	fileInfo<span class="token punctuation">.</span><span class="token function">setFilePath</span><span class="token punctuation">(</span>fileName<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token function">toAjax</span><span class="token punctuation">(</span>fileInfoService<span class="token punctuation">.</span><span class="token function">insertFileInfo</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>4、上传成功后需要预览可以对该属性格式化处理</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
	<span class="token literal-property property">field</span> <span class="token operator">:</span> <span class="token string">'filePath'</span><span class="token punctuation">,</span> 
	<span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">'文件预览'</span><span class="token punctuation">,</span>
	<span class="token function-variable function">formatter</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> row<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> $<span class="token punctuation">.</span>table<span class="token punctuation">.</span><span class="token function">imageView</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>如需对文件格式控制，设置<code>application.yml</code>中的<code>multipart</code>属性</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token comment"># 文件上传</span>
<span class="token key atrule">servlet</span><span class="token punctuation">:</span>
   <span class="token key atrule">multipart</span><span class="token punctuation">:</span>
     <span class="token comment"># 单个文件大小</span>
     <span class="token key atrule">max-file-size</span><span class="token punctuation">:</span>  10MB
     <span class="token comment"># 设置总上传的文件大小</span>
     <span class="token key atrule">max-request-size</span><span class="token punctuation">:</span>  20MB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>注意：如果只是单纯的上传一张图片没有其他参数可以使用通用方法 <code>/common/upload</code><br>
请求处理方法 <code>com.ruoyi.web.controller.common.CommonController</code></p> <h3 id="下载实现流程"><a href="#下载实现流程" class="header-anchor">#</a> 下载实现流程</h3> <p>1、参考示例代码。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">downloadFile</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href <span class="token operator">=</span> ctx <span class="token operator">+</span> <span class="token string">&quot;common/download/resource?resource=&quot;</span> <span class="token operator">+</span> value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2、参考<code>Controller</code>下载方法</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 本地资源通用下载
 */</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/common/download/resource&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">resourceDownload</span><span class="token punctuation">(</span><span class="token class-name">String</span> resource<span class="token punctuation">,</span> <span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span>
		<span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 本地资源路径</span>
	<span class="token class-name">String</span> localPath <span class="token operator">=</span> <span class="token class-name">Global</span><span class="token punctuation">.</span><span class="token function">getProfile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 数据库资源地址</span>
	<span class="token class-name">String</span> downloadPath <span class="token operator">=</span> localPath <span class="token operator">+</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">substringAfter</span><span class="token punctuation">(</span>resource<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">RESOURCE_PREFIX</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 下载名称</span>
	<span class="token class-name">String</span> downloadName <span class="token operator">=</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">substringAfterLast</span><span class="token punctuation">(</span>downloadPath<span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	response<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;multipart/form-data&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span>
			<span class="token string">&quot;attachment;fileName=&quot;</span> <span class="token operator">+</span> <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">setFileDownloadHeader</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> downloadName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">writeBytes</span><span class="token punctuation">(</span>downloadPath<span class="token punctuation">,</span> response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="权限注解"><a href="#权限注解" class="header-anchor">#</a> 权限注解</h2> <p><code>Shiro</code>注解权限控制</p> <ul><li><code>@RequiresAuthentication</code>使用该注解标注的类，实例，方法在访问或调用时，当前Subject必须在当前session中已经过认证。</li> <li><code>@RequiresGuest</code>使用该注解标注的类，实例，方法在访问或调用时，当前Subject可以是gust身份，不需要经过认证或者在原先的session中存在记录。</li> <li><code>@RequiresPermissions</code>当前Subject需要拥有某些特定的权限时，才能执行被该注解标注的方法。如果当前Subject不具有这样的权限，则方法不会被执行。</li> <li><code>@RequiresRoles</code>当前Subject必须拥有所有指定的角色时，才能访问被该注解标注的方法。如果当天Subject不同时拥有所有指定角色，则方法不会执行还会抛出AuthorizationException异常。</li> <li><code>@RequiresUser</code>当前Subject必须是应用的用户，才能访问或调用被该注解标注的类，实例，方法。</li></ul> <h3 id="requiresroles"><a href="#requiresroles" class="header-anchor">#</a> @RequiresRoles</h3> <p><code>@RequiresRoles</code>注解用于配置接口要求用户拥有某（些）角色才可访问，它拥有两个参数</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>value</td> <td>String[]</td> <td>角色列表</td></tr> <tr><td>logical</td> <td>Logical</td> <td>角色之间的判断关系，默认为Logical.AND</td></tr></tbody></table> <p>示例1: 以下代码表示必须拥有<code>admin</code>角色才可访问</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RequiresRoles</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>示例2: 以下代码表示必须拥有<code>admin</code>和<code>common</code>角色才可访问</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RequiresRoles</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;common&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>示例3: 以下代码表示需要拥有<code>admin</code>或<code>common</code>角色才可访问</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RequiresRoles</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;common&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> logical <span class="token operator">=</span> <span class="token class-name">Logical</span><span class="token punctuation">.</span><span class="token constant">OR</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="requirespermissions"><a href="#requirespermissions" class="header-anchor">#</a> @RequiresPermissions</h3> <p><code>@RequiresPermissions</code>注解用于配置接口要求用户拥有某（些）权限才可访问，它拥有两个参数</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>value</td> <td>String[]</td> <td>权限列表</td></tr> <tr><td>logical</td> <td>Logical</td> <td>权限之间的判断关系，默认为Logical.AND</td></tr></tbody></table> <p>示例1: 以下代码表示必须拥有<code>system:user:add</code>权限才可访问</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RequiresPermissions</span><span class="token punctuation">(</span><span class="token string">&quot;system:user:add&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>示例2: 以下代码表示必须拥有<code>system:user:add</code>和<code>system:user:update</code>权限才可访问</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RequiresPermissions</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;system:user:add&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;system:user:update&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>示例3: 以下代码表示需要拥有<code>system:user:add</code>或<code>system:user:update</code>角色才可访问</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RequiresPermissions</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;system:user:add&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;system:user:update&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> logical <span class="token operator">=</span> <span class="token class-name">Logical</span><span class="token punctuation">.</span><span class="token constant">OR</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>Shiro的认证注解处理是有内定的处理顺序的，如果有个多个注解的话，前面的通过了会继续检查后面的，若不通过则直接返回，处理顺序依次为（与实际声明顺序无关）
RequiresRoles、RequiresPermissions、RequiresAuthentication、RequiresUser、RequiresGuest。<br>
例如：你同时声明了<code>RequiresRoles</code>和<code>RequiresPermissions</code>，那就要求拥有此角色的同时还得拥有相应的权限。</p></div> <h2 id="事务管理"><a href="#事务管理" class="header-anchor">#</a> 事务管理</h2> <p>新建的<code>Spring Boot</code>项目中，一般都会引用<code>spring-boot-starter</code>或者<code>spring-boot-starter-web</code>，而这两个起步依赖中都已经包含了对于<code>spring-boot-starter-jdbc</code>或<code>spring-boot-starter-data-jpa</code>的依赖。
当我们使用了这两个依赖的时候，框架会自动默认分别注入<code>DataSourceTransactionManager</code>或<code>JpaTransactionManager</code>。
所以我们不需要任何额外配置就可以用<code>@Transactional</code>注解进行事务的使用。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>@Transactional注解只能应用到public可见度的方法上，可以被应用于接口定义和接口方法，方法会覆盖类上面声明的事务。</p></div> <p>例如用户新增需要插入用户表、用户与岗位关联表、用户与角色关联表，如果插入成功，那么一起成功，如果中间有一条出现异常，那么回滚之前的所有操作，
这样可以防止出现脏数据，就可以使用事务让它实现回退。<br>
做法非常简单，我们只需要在方法或类添加<code>@Transactional</code>注解即可。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 新增用户信息</span>
	<span class="token keyword">int</span> rows <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户岗位关联</span>
	<span class="token function">insertUserPost</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户与角色管理</span>
	<span class="token function">insertUserRole</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> rows<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>常见坑点1：遇到检查异常时，事务开启，也无法回滚。
例如下面这段代码，用户依旧增加成功，并没有因为后面遇到检查异常而回滚！！</li></ul> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 新增用户信息</span>
	<span class="token keyword">int</span> rows <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户岗位关联</span>
	<span class="token function">insertUserPost</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户与角色管理</span>
	<span class="token function">insertUserRole</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 模拟抛出SQLException异常</span>
	<span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SQLException</span><span class="token punctuation">(</span><span class="token string">&quot;发生异常了..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> rows<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>原因分析：因为<code>Spring</code>的默认的事务规则是遇到运行异常<code>（RuntimeException）</code>和程序错误<code>（Error）</code>才会回滚。如果想针对检查异常进行事务回滚，可以在<code>@Transactional</code>注解里使用
<code>rollbackFor</code>属性明确指定异常。<br>
例如下面这样，就可以正常回滚：</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 新增用户信息</span>
	<span class="token keyword">int</span> rows <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户岗位关联</span>
	<span class="token function">insertUserPost</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户与角色管理</span>
	<span class="token function">insertUserRole</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 模拟抛出SQLException异常</span>
	<span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SQLException</span><span class="token punctuation">(</span><span class="token string">&quot;发生异常了..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> rows<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li>常见坑点2： 在业务层捕捉异常后，发现事务不生效。
这是许多新手都会犯的一个错误，在业务层手工捕捉并处理了异常，你都把异常“吃”掉了，<code>Spring</code>自然不知道这里有错，更不会主动去回滚数据。<br>
例如：下面这段代码直接导致用户新增的事务回滚没有生效。</li></ul> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 新增用户信息</span>
	<span class="token keyword">int</span> rows <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户岗位关联</span>
	<span class="token function">insertUserPost</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户与角色管理</span>
	<span class="token function">insertUserRole</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 模拟抛出SQLException异常</span>
	<span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">try</span>
		<span class="token punctuation">{</span>
			<span class="token comment">// 谨慎：尽量不要在业务层捕捉异常并处理</span>
			<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">SQLException</span><span class="token punctuation">(</span><span class="token string">&quot;发生异常了..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> rows<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>推荐做法：在业务层统一抛出异常，然后在控制层统一处理。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertUser</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span>
<span class="token punctuation">{</span>
	<span class="token comment">// 新增用户信息</span>
	<span class="token keyword">int</span> rows <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">insertUser</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户岗位关联</span>
	<span class="token function">insertUserPost</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 新增用户与角色管理</span>
	<span class="token function">insertUserRole</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 模拟抛出SQLException异常</span>
	<span class="token keyword">boolean</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;发生异常了..&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> rows<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><code>Transactional</code>注解的常用属性表：</p> <table><thead><tr><th>属性</th> <th>说明</th></tr></thead> <tbody><tr><td>propagation</td> <td>事务的传播行为，默认值为 REQUIRED。</td></tr> <tr><td>isolation</td> <td>事务的隔离度，默认值采用 DEFAULT</td></tr> <tr><td>timeout</td> <td>事务的超时时间，默认值为-1，不超时。如果设置了超时时间(单位秒)，那么如果超过该时间限制了但事务还没有完成，则自动回滚事务。</td></tr> <tr><td>read-only</td> <td>指定事务是否为只读事务，默认值为 false；为了忽略那些不需要事务的方法，比如读取数据，可以设置 read-only 为 true。</td></tr> <tr><td>rollbackFor</td> <td>用于指定能够触发事务回滚的异常类型，如果有多个异常类型需要指定，各类型之间可以通过逗号分隔。{xxx1.class, xxx2.class,……}</td></tr> <tr><td>noRollbackFor</td> <td>抛出 no-rollback-for 指定的异常类型，不回滚事务。{xxx1.class, xxx2.class,……}</td></tr> <tr><td>....</td> <td></td></tr></tbody></table> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>事务的传播机制是指如果在开始当前事务之前，一个事务上下文已经存在，此时有若干选项可以指定一个事务性方法的执行行为。
即:在执行一个@Transactinal注解标注的方法时，开启了事务；当该方法还在执行中时，另一个人也触发了该方法；那么此时怎么算事务呢，这时就可以通过事务的传播机制来指定处理方式。</p></div> <p><code>TransactionDefinition</code>传播行为的常量：</p> <table><thead><tr><th>常量</th> <th>含义</th></tr></thead> <tbody><tr><td>TransactionDefinition.PROPAGATION_REQUIRED</td> <td>如果当前存在事务，则加入该事务；如果当前没有事务，则创建一个新的事务。这是默认值。</td></tr> <tr><td>TransactionDefinition.PROPAGATION_REQUIRES_NEW</td> <td>创建一个新的事务，如果当前存在事务，则把当前事务挂起。</td></tr> <tr><td>TransactionDefinition.PROPAGATION_SUPPORTS</td> <td>如果当前存在事务，则加入该事务；如果当前没有事务，则以非事务的方式继续运行。</td></tr> <tr><td>TransactionDefinition.PROPAGATION_NOT_SUPPORTED</td> <td>以非事务方式运行，如果当前存在事务，则把当前事务挂起。</td></tr> <tr><td>TransactionDefinition.PROPAGATION_NEVER</td> <td>以非事务方式运行，如果当前存在事务，则抛出异常。</td></tr> <tr><td>TransactionDefinition.PROPAGATION_MANDATORY</td> <td>如果当前存在事务，则加入该事务；如果当前没有事务，则抛出异常。</td></tr> <tr><td>TransactionDefinition.PROPAGATION_NESTED</td> <td>如果当前存在事务，则创建一个事务作为当前事务的嵌套事务来运行；如果当前没有事务，则该取值等价于TransactionDefinition.PROPAGATION_REQUIRED。</td></tr></tbody></table> <h2 id="异常处理"><a href="#异常处理" class="header-anchor">#</a> 异常处理</h2> <p>通常一个<code>web</code>框架中，有大量需要处理的异常。比如业务异常，权限不足等等。前端通过弹出提示信息的方式告诉用户出了什么错误。
通常情况下我们用<code>try.....catch....</code>对异常进行捕捉处理，但是在实际项目中对业务模块进行异常捕捉，会造成代码重复和繁杂，
我们希望代码中只有业务相关的操作，所有的异常我们单独设立一个类来处理它。全局异常就是对框架所有异常进行统一管理。
我们在可能发生异常的方法里<code>throw</code>抛给控制器。然后由全局异常处理器对异常进行统一处理。
如此，我们的<code>Controller</code>中的方法就可以很简洁了。</p> <p>所谓全局异常处理器就是使用<code>@ControllerAdvice</code>注解。示例如下：</p> <p>1、统一返回实体定义</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>common<span class="token punctuation">.</span>core<span class="token punctuation">.</span>domain</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 操作消息提醒
 * 
 * @author ruoyi
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AjaxResult</span> <span class="token keyword">extends</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 返回错误消息
     * 
     * @param code 错误码
     * @param msg 内容
     * @return 错误消息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">AjaxResult</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">AjaxResult</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> json<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 返回成功消息
     * 
     * @param msg 内容
     * @return 成功消息
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">AjaxResult</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">AjaxResult</span> json <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        json<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> json<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p>2、定义登录异常定义</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 登录异常
 * 
 * @author ruoyi
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LoginException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token keyword">protected</span> <span class="token keyword">final</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">LoginException</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><p>3、基于<code>@ControllerAdvice</code>注解的<code>Controller</code>层的全局异常统一处理</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>framework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>exception</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">ExceptionHandler</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestControllerAdvice</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>common<span class="token punctuation">.</span>core<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">AjaxResult</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>ruoyi<span class="token punctuation">.</span>common<span class="token punctuation">.</span>exception<span class="token punctuation">.</span></span><span class="token class-name">LoginException</span></span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 全局异常处理器
 * 
 * @author ruoyi
 */</span>
<span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> log <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">GlobalExceptionHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token comment">/**
     * 登录异常
     */</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">LoginException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">loginException</span><span class="token punctuation">(</span><span class="token class-name">LoginException</span> e<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>4、测试访问请求</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysIndexController</span> 
<span class="token punctuation">{</span>
    <span class="token comment">/**
     * 首页方法
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/index&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token class-name">ModelMap</span> mmap<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">/**
         * 模拟用户未登录，抛出业务逻辑异常
         */</span>
        <span class="token class-name">SysUser</span> user <span class="token operator">=</span> <span class="token class-name">ShiroUtils</span><span class="token punctuation">.</span><span class="token function">getSysUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNull</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">LoginException</span><span class="token punctuation">(</span><span class="token string">&quot;用户未登录，无法访问请求。&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
		mmap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;index&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>根据上面代码含义，当我们未登录访问<code>/index</code>时就会发生<code>LoginException</code>业务逻辑异常，按照我们之前的全局异常配置以及统一返回实体实例化，访问后会出现<code>AjaxResult</code>格式<code>JSON</code>数据，
下面我们运行项目访问查看效果。<br>
界面输出内容如下所示：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;msg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;用户未登录，无法访问请求。&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token number">500</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>对于一些特殊情况，如接口需要返回<code>json</code>，页面请求返回<code>html</code>可以使用如下方法：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">LoginException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">loginException</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">LoginException</span> e<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ServletUtils</span><span class="token punctuation">.</span><span class="token function">isAjaxRequest</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token class-name">AjaxResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ModelAndView</span><span class="token punctuation">(</span><span class="token string">&quot;/error/500&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>若依系统的全局异常处理器<code>GlobalExceptionHandler</code><br>
注意：如果全部异常处理返回<code>json</code>，那么可以使用<code>@RestControllerAdvice</code>代替<code>@ControllerAdvice</code>，这样在方法上就可以不需要添加<code>@ResponseBody</code>。</p> <div class="custom-block warning"><p class="custom-block-title">无法捕获异常？</p> <p>如果您的异常无法捕获，您可以从以下几个方面着手检查</p> <p>异常是否已被处理，即抛出异常后被catch，打印了日志或抛出了其它异常
异常是否非Controller抛出，即在拦截器或过滤器中出现的异常</p></div> <h2 id="参数验证"><a href="#参数验证" class="header-anchor">#</a> 参数验证</h2> <p><code>spring boot</code>中可以用<code>@Validated</code>来校验数据，如果数据异常则会统一抛出异常，方便异常中心统一处理。</p> <h3 id="注解参数说明-2"><a href="#注解参数说明-2" class="header-anchor">#</a> 注解参数说明</h3> <table><thead><tr><th>注解名称</th> <th>功能</th></tr></thead> <tbody><tr><td>@Xss</td> <td>检查该字段是否存在跨站脚本工具</td></tr> <tr><td>@Null</td> <td>检查该字段为空</td></tr> <tr><td>@NotNull</td> <td>不能为null</td></tr> <tr><td>@NotBlank</td> <td>不能为空，常用于检查空字符串</td></tr> <tr><td>@NotEmpty</td> <td>不能为空，多用于检测list是否size是0</td></tr> <tr><td>@Max</td> <td>该字段的值只能小于或等于该值</td></tr> <tr><td>@Min</td> <td>该字段的值只能大于或等于该值</td></tr> <tr><td>@Past</td> <td>检查该字段的日期是在过去</td></tr> <tr><td>@Future</td> <td>检查该字段的日期是否是属于将来的日期</td></tr> <tr><td>@Email</td> <td>检查是否是一个有效的email地址</td></tr> <tr><td>@Pattern(regex=,flag=)</td> <td>被注释的元素必须符合指定的正则表达式</td></tr> <tr><td>@Range(min=,max=,message=)</td> <td>被注释的元素必须在合适的范围内</td></tr> <tr><td>@Size(min=, max=)</td> <td>检查该字段的size是否在min和max之间，可以是字符串、数组、集合、Map等</td></tr> <tr><td>@Length(min=,max=)</td> <td>检查所属的字段的长度是否在min和max之间,只能用于字符串</td></tr> <tr><td>@AssertTrue</td> <td>用于boolean字段，该字段只能为true</td></tr> <tr><td>@AssertFalse</td> <td>该字段的值只能为false</td></tr></tbody></table> <h3 id="数据校验使用"><a href="#数据校验使用" class="header-anchor">#</a> 数据校验使用</h3> <p>1、基础使用
因为<code>spring boot</code>已经引入了基础包，所以直接使用就可以了。首先在<code>controller</code>上声明<code>@Validated</code>需要对数据进行校验。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br></div><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">SysUser</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2、然后在对应字段<code>Get方法</code>加上参数校验注解，如果不符合验证要求，则会以<code>message</code>的信息为准，返回给前端。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;用户昵称长度不能超过30个字符&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getNickName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> nickName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;用户账号不能为空&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;用户账号长度不能超过30个字符&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> userName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;邮箱格式不正确&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;邮箱长度不能超过50个字符&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;手机号码长度不能超过11个字符&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getPhonenumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> phonenumber<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">也可以直接放在字段上面声明。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;用户昵称长度不能超过30个字符&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> nickName<span class="token punctuation">;</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></div> <h3 id="自定义注解校验"><a href="#自定义注解校验" class="header-anchor">#</a> 自定义注解校验</h3> <p>使用原生的<code>@Validated</code>进行参数校验时，都是特定的注解去校验（例如字段长度、大小、不为空等），我们也可以用自定义的注解去进行校验，例如项目中的<code>@Xss</code>注解。</p> <p>1、新增<code>Xss</code>注解，设置自定义校验器<code>XssValidator.class</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 自定义xss校验注解
 * 
 * @author ruoyi
 */</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">FIELD</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">CONSTRUCTOR</span><span class="token punctuation">,</span> <span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">PARAMETER</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Constraint</span><span class="token punctuation">(</span>validatedBy <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token class-name">XssValidator</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Xss</span>
<span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">message</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">default</span> <span class="token string">&quot;不允许任何脚本运行&quot;</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">groups</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Payload</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">payload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>2、自定义<code>Xss</code>校验器，实现<code>ConstraintValidator</code>接口。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 自定义xss校验注解实现
 * 
 * @author ruoyi
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XssValidator</span> <span class="token keyword">implements</span> <span class="token class-name">ConstraintValidator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Xss</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">HTML_PATTERN</span> <span class="token operator">=</span> <span class="token string">&quot;&lt;(\\S*?)[^&gt;]*&gt;.*?|&lt;.*? /&gt;&quot;</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isValid</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token class-name">ConstraintValidatorContext</span> constraintValidatorContext<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">!</span><span class="token function">containsHtml</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">containsHtml</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">Pattern</span> pattern <span class="token operator">=</span> <span class="token class-name">Pattern</span><span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span><span class="token constant">HTML_PATTERN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Matcher</span> matcher <span class="token operator">=</span> pattern<span class="token punctuation">.</span><span class="token function">matcher</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> matcher<span class="token punctuation">.</span><span class="token function">matches</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>3、实体类使用自定义的<code>@Xss</code>注解</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Xss</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;登录账号不能包含脚本字符&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;登录账号不能为空&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> max <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;登录账号长度不能超过30个字符&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLoginName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> loginName<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>此时在去保存会进行验证，如果不符合规则的字符（例如<code>&lt;script&gt;alert(1);&lt;/script&gt;</code>）会提示<code>登录账号不能包含脚本字符</code>，代表限制成功。</p> <div class="custom-block warning"><p class="custom-block-title">如果是在方法里面校验整个实体，参考示例。</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">protected</span> <span class="token class-name">Validator</span> validator<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">importUser</span><span class="token punctuation">(</span><span class="token class-name">SysUser</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token class-name">BeanValidators</span><span class="token punctuation">.</span><span class="token function">validateWithException</span><span class="token punctuation">(</span>validator<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <h3 id="自定义分组校验"><a href="#自定义分组校验" class="header-anchor">#</a> 自定义分组校验</h3> <p>有时候我们为了在使用实体类的情况下更好的区分出新增、修改和其他操作验证的不同，可以通过<code>groups</code>属性设置。使用方式如下</p> <p><strong>新增类接口，用于标识出不同的操作类型</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Add</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Edit</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>Controller.java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 新增</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">addSave</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">Add</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Xxxx</span> xxxx<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">success</span><span class="token punctuation">(</span>xxxx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 编辑</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">editSave</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span><span class="token punctuation">(</span><span class="token class-name">Edit</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">Xxxx</span> xxxx<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">success</span><span class="token punctuation">(</span>xxxx<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>Model.java</strong></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 仅在新增时验证</span>
<span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;不能为空&quot;</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Add</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> xxxx<span class="token punctuation">;</span>

<span class="token comment">// 在新增和修改时验证</span>
<span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;不能为空&quot;</span><span class="token punctuation">,</span> groups <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">Add</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">Edit</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> xxxx<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="custom-block tip"><p class="custom-block-title">提示</p> <p>如果你有更多操作类型，也可以自定义类统一管理，使用方式就变成了<code>Type.Add</code>、<code>Type.Edit</code>、<code>Type.Xxxx</code>等。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>eva<span class="token punctuation">.</span>core<span class="token punctuation">.</span>constants</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * 操作类型
 */</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Type</span> 
<span class="token punctuation">{</span>
    <span class="token keyword">interface</span> <span class="token class-name">Add</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">interface</span> <span class="token class-name">Edit</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">interface</span> <span class="token class-name">Xxxx</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></div> <h2 id="系统日志"><a href="#系统日志" class="header-anchor">#</a> 系统日志</h2> <p>在实际开发中，对于某些关键业务，我们通常需要记录该操作的内容，一个操作调一次记录方法，每次还得去收集参数等等，会造成大量代码重复。
我们希望代码中只有业务相关的操作，在项目中使用注解来完成此项功能。</p> <p>在需要被记录日志的<code>controller</code>方法上添加<code>@Log</code>注解，使用方法如下：</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;用户管理&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">INSERT</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">addSave</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="注解参数说明-3"><a href="#注解参数说明-3" class="header-anchor">#</a> 注解参数说明</h3> <table><thead><tr><th>参数</th> <th>类型</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>title</td> <td>String</td> <td>空</td> <td>操作模块</td></tr> <tr><td>businessType</td> <td>BusinessType</td> <td>OTHER</td> <td>操作功能（<code>OTHER</code>其他、<code>INSERT</code>新增、<code>UPDATE</code>修改、<code>DELETE</code>删除、<code>GRANT</code>授权、<code>EXPORT</code>导出、<code>IMPORT</code>导入、<code>FORCE</code>强退、<code>GENCODE</code>生成代码、<code>CLEAN</code>清空数据）</td></tr> <tr><td>operatorType</td> <td>OperatorType</td> <td>MANAGE</td> <td>操作人类别（<code>OTHER</code>其他、<code>MANAGE</code>后台用户、<code>MOBILE</code>手机端用户）</td></tr> <tr><td>isSaveRequestData</td> <td>boolean</td> <td>true</td> <td>是否保存请求的参数</td></tr> <tr><td>isSaveResponseData</td> <td>boolean</td> <td>true</td> <td>是否保存响应的参数</td></tr></tbody></table> <h3 id="自定义操作功能"><a href="#自定义操作功能" class="header-anchor">#</a> 自定义操作功能</h3> <p>1、在<code>BusinessType</code>中新增业务操作类型如:</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br></div><pre class="language-java"><code><span class="token comment">/**
 * 测试
 */</span>
<span class="token constant">TEST</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2、在<code>sys_dict_data</code>字典数据表中初始化操作业务类型</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">insert</span> <span class="token keyword">into</span> sys_dict_data <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'测试'</span><span class="token punctuation">,</span>     <span class="token string">'10'</span><span class="token punctuation">,</span> <span class="token string">'sys_oper_type'</span><span class="token punctuation">,</span>       <span class="token string">''</span><span class="token punctuation">,</span>   <span class="token string">'primary'</span><span class="token punctuation">,</span> <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'2018-03-16 11-33-00'</span><span class="token punctuation">,</span> <span class="token string">'ry'</span><span class="token punctuation">,</span> <span class="token string">'2018-03-16 11-33-00'</span><span class="token punctuation">,</span> <span class="token string">'测试操作'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>3、在<code>Controller</code>中使用注解</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;测试标题&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">TEST</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>操作日志记录逻辑实现代码<a href="https://gitee.com/y_project/RuoYi/blob/master/ruoyi-framework/src/main/java/com/ruoyi/framework/aspectj/LogAspect.java" target="_blank" rel="noopener noreferrer">LogAspect.java<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a><br>
登录系统（系统管理-操作日志）可以查询操作日志列表和详细信息。</p> <h2 id="数据权限"><a href="#数据权限" class="header-anchor">#</a> 数据权限</h2> <p>在实际开发中，需要设置用户只能查看哪些部门的数据，这种情况一般称为数据权限。<br>
例如对于销售，财务的数据，它们是非常敏感的，因此要求对数据权限进行控制，
对于基于集团性的应用系统而言，就更多需要控制好各自公司的数据了。如设置只能看本公司、或者本部门的数据，对于特殊的领导，可能需要跨部门的数据，
因此程序不能硬编码那个领导该访问哪些数据，需要进行后台的权限和数据权限的控制。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>默认系统管理员<code>admin</code>拥有所有数据权限<code>（userId=1）</code>，默认角色拥有所有数据权限（如不需要数据权限不用设置数据权限操作）</p></div> <h3 id="注解参数说明-4"><a href="#注解参数说明-4" class="header-anchor">#</a> 注解参数说明</h3> <table><thead><tr><th>参数</th> <th>类型</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>deptAlias</td> <td>String</td> <td>空</td> <td>部门表的别名</td></tr> <tr><td>userAlias</td> <td>String</td> <td>空</td> <td>用户表的别名</td></tr></tbody></table> <h3 id="数据权限使用"><a href="#数据权限使用" class="header-anchor">#</a> 数据权限使用</h3> <p>1、在（系统管理-角色管理）设置需要数据权限的角色
目前支持以下几种权限</p> <ul><li>全部数据权限</li> <li>自定数据权限</li> <li>部门数据权限</li> <li>部门及以下数据权限</li> <li>仅本人数据权限</li></ul> <p>2、在需要数据权限控制方法上添加<code>@DataScope</code>注解，其中<code>d</code>和<code>u</code>用来表示表的别名</p> <p><strong>部门数据权限注解</strong></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@DataScope</span><span class="token punctuation">(</span>deptAlias <span class="token operator">=</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&gt;</span></span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>部门及用户权限注解</strong></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@DataScope</span><span class="token punctuation">(</span>deptAlias <span class="token operator">=</span> <span class="token string">&quot;d&quot;</span><span class="token punctuation">,</span> userAlias <span class="token operator">=</span> <span class="token string">&quot;u&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&gt;</span></span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3、在<code>mybatis</code>查询底部标签添加数据范围过滤</p> <div class="language-xml line-numbers-mode"><div class="highlight-lines"><br><br><br><div class="highlighted"> </div><br><br></div><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>...Result<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">refid</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>select...Vo<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 数据范围过滤 --&gt;</span>
    ${params.dataScope}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>例如：用户管理（未过滤数据权限的情况）：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">select</span> u<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> u<span class="token punctuation">.</span>dept_id<span class="token punctuation">,</span> u<span class="token punctuation">.</span>login_name<span class="token punctuation">,</span> u<span class="token punctuation">.</span>user_name<span class="token punctuation">,</span> u<span class="token punctuation">.</span>email
	<span class="token punctuation">,</span> u<span class="token punctuation">.</span>phonenumber<span class="token punctuation">,</span> u<span class="token punctuation">.</span>password<span class="token punctuation">,</span> u<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> u<span class="token punctuation">.</span>avatar<span class="token punctuation">,</span> u<span class="token punctuation">.</span>salt
	<span class="token punctuation">,</span> u<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>del_flag<span class="token punctuation">,</span> u<span class="token punctuation">.</span>login_ip<span class="token punctuation">,</span> u<span class="token punctuation">.</span>login_date<span class="token punctuation">,</span> u<span class="token punctuation">.</span>create_by
	<span class="token punctuation">,</span> u<span class="token punctuation">.</span>create_time<span class="token punctuation">,</span> u<span class="token punctuation">.</span>remark<span class="token punctuation">,</span> d<span class="token punctuation">.</span>dept_name
<span class="token keyword">from</span> sys_user u
	<span class="token keyword">left</span> <span class="token keyword">join</span> sys_dept d <span class="token keyword">on</span> u<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>dept_id
<span class="token keyword">where</span> u<span class="token punctuation">.</span>del_flag <span class="token operator">=</span> <span class="token string">'0'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>例如：用户管理（已过滤数据权限的情况）：</p> <div class="language-sql line-numbers-mode"><div class="highlight-lines"><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-sql"><code><span class="token keyword">select</span> u<span class="token punctuation">.</span>user_id<span class="token punctuation">,</span> u<span class="token punctuation">.</span>dept_id<span class="token punctuation">,</span> u<span class="token punctuation">.</span>login_name<span class="token punctuation">,</span> u<span class="token punctuation">.</span>user_name<span class="token punctuation">,</span> u<span class="token punctuation">.</span>email
	<span class="token punctuation">,</span> u<span class="token punctuation">.</span>phonenumber<span class="token punctuation">,</span> u<span class="token punctuation">.</span>password<span class="token punctuation">,</span> u<span class="token punctuation">.</span>sex<span class="token punctuation">,</span> u<span class="token punctuation">.</span>avatar<span class="token punctuation">,</span> u<span class="token punctuation">.</span>salt
	<span class="token punctuation">,</span> u<span class="token punctuation">.</span><span class="token keyword">status</span><span class="token punctuation">,</span> u<span class="token punctuation">.</span>del_flag<span class="token punctuation">,</span> u<span class="token punctuation">.</span>login_ip<span class="token punctuation">,</span> u<span class="token punctuation">.</span>login_date<span class="token punctuation">,</span> u<span class="token punctuation">.</span>create_by
	<span class="token punctuation">,</span> u<span class="token punctuation">.</span>create_time<span class="token punctuation">,</span> u<span class="token punctuation">.</span>remark<span class="token punctuation">,</span> d<span class="token punctuation">.</span>dept_name
<span class="token keyword">from</span> sys_user u
	<span class="token keyword">left</span> <span class="token keyword">join</span> sys_dept d <span class="token keyword">on</span> u<span class="token punctuation">.</span>dept_id <span class="token operator">=</span> d<span class="token punctuation">.</span>dept_id
<span class="token keyword">where</span> u<span class="token punctuation">.</span>del_flag <span class="token operator">=</span> <span class="token string">'0'</span>
	<span class="token operator">and</span> u<span class="token punctuation">.</span>dept_id <span class="token operator">in</span> <span class="token punctuation">(</span>
		<span class="token keyword">select</span> dept_id
		<span class="token keyword">from</span> sys_role_dept
		<span class="token keyword">where</span> role_id <span class="token operator">=</span> <span class="token number">2</span>
	<span class="token punctuation">)</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>结果很明显，我们多了如下语句。通过角色部门表<code>（sys_role_dept）</code>完成了数据权限过滤</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token operator">and</span> u<span class="token punctuation">.</span>dept_id <span class="token operator">in</span> <span class="token punctuation">(</span>
	<span class="token keyword">select</span> dept_id
	<span class="token keyword">from</span> sys_role_dept
	<span class="token keyword">where</span> role_id <span class="token operator">=</span> <span class="token number">2</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>逻辑实现代码 <code>com.ruoyi.framework.aspectj.DataScopeAspect</code></p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>仅实体继承<code>BaseEntity</code>才会进行处理，<code>SQL</code>语句会存放到<code>BaseEntity</code>对象中的<code>params</code>属性中，然后在<code>xml</code>中通过<code>${params.dataScope}</code>获取拼接后的语句。</p></div> <h2 id="多数据源"><a href="#多数据源" class="header-anchor">#</a> 多数据源</h2> <p>在实际开发中，经常可能遇到在一个应用中可能需要访问多个数据库的情况，在项目中使用注解来完成此项功能。</p> <p>在需要被切换数据源的<code>Service</code>或<code>Mapper</code>方法上添加<code>@DataSource</code>注解，使用方法如下：</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@DataSource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">DataSourceType</span><span class="token punctuation">.</span><span class="token constant">MASTER</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">&gt;</span></span> <span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> mapper<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>其中<code>value</code>用来表示数据源名称，除<code>MASTER</code>和<code>SLAVE</code>其他均需要进行配置。</p> <h3 id="注解参数说明-5"><a href="#注解参数说明-5" class="header-anchor">#</a> 注解参数说明</h3> <table><thead><tr><th>参数</th> <th>类型</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>value</td> <td>DataSourceType</td> <td>DataSourceType.MASTER</td> <td>主库</td></tr></tbody></table> <h3 id="多数据源使用"><a href="#多数据源使用" class="header-anchor">#</a> 多数据源使用</h3> <p>1、在<code>application-druid.yml</code>配置从库数据源</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token comment"># 从库数据源</span>
<span class="token key atrule">slave</span><span class="token punctuation">:</span>
	<span class="token comment"># 从数据源开关/默认关闭</span>
	<span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
	<span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/test<span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=utf8&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=true&amp;serverTimezone=GMT%2B8</span>
	<span class="token key atrule">username</span><span class="token punctuation">:</span> root
	<span class="token key atrule">password</span><span class="token punctuation">:</span> password
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>2、在<code>DataSourceType</code>类添加数据源枚举</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 从库
 */</span>
<span class="token constant">SLAVE</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>3、在<code>DruidConfig</code>配置读取数据源</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span><span class="token string">&quot;spring.datasource.druid.slave&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;spring.datasource.druid.slave&quot;</span><span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">&quot;enabled&quot;</span><span class="token punctuation">,</span> havingValue <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">slaveDataSource</span><span class="token punctuation">(</span><span class="token class-name">DruidProperties</span> druidProperties<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name">DruidDataSource</span> dataSource <span class="token operator">=</span> <span class="token class-name">DruidDataSourceBuilder</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> druidProperties<span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>4、在<code>DruidConfig</code>类<code>dataSource</code>方法添加数据源</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token function">setDataSource</span><span class="token punctuation">(</span>targetDataSources<span class="token punctuation">,</span> <span class="token class-name">DataSourceType</span><span class="token punctuation">.</span><span class="token constant">SLAVE</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;slaveDataSource&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>5、在需要使用多数据源方法或类上添加<code>@DataSource</code>注解，其中<code>value</code>用来表示数据源</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@DataSource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">DataSourceType</span><span class="token punctuation">.</span><span class="token constant">SLAVE</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectUserList</span><span class="token punctuation">(</span><span class="token class-name">SysUser</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">return</span> userMapper<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-java line-numbers-mode"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@DataSource</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">DataSourceType</span><span class="token punctuation">.</span><span class="token constant">SLAVE</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SysUserServiceImpl</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="手动切换数据源"><a href="#手动切换数据源" class="header-anchor">#</a> 手动切换数据源</h3> <p>在需要切换数据源的方法中使用<code>DynamicDataSourceContextHolder</code>类实现手动切换，使用方法如下：</p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><br><br><div class="highlighted"> </div><br><div class="highlighted"> </div><br><br><br></div><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> <span class="token function">selectUserList</span><span class="token punctuation">(</span><span class="token class-name">SysUser</span> user<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token class-name">DynamicDataSourceContextHolder</span><span class="token punctuation">.</span><span class="token function">setDataSourceType</span><span class="token punctuation">(</span><span class="token class-name">DataSourceType</span><span class="token punctuation">.</span><span class="token constant">SLAVE</span><span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SysUser</span><span class="token punctuation">&gt;</span></span> userList <span class="token operator">=</span> userMapper<span class="token punctuation">.</span><span class="token function">selectUserList</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">DynamicDataSourceContextHolder</span><span class="token punctuation">.</span><span class="token function">clearDataSourceType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> userList<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>逻辑实现代码 <code>com.ruoyi.framework.aspectj.DataSourceAspect</code></p> <p><code>注意：目前配置了一个从库，默认关闭状态。如果不需要多数据源不用做任何配置。 另外可新增多个从库。支持不同数据源（Mysql、Oracle、SQLServer）</code></p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>如果有<code>Service</code>方法内多个注解无效的情况使用内部方法调用<code>SpringUtils.getAopProxy(this).xxxxxx(xxxx)</code>;</p></div> <h2 id="代码生成"><a href="#代码生成" class="header-anchor">#</a> 代码生成</h2> <p>大部分项目里其实有很多代码都是重复的，几乎每个基础模块的代码都有增删改查的功能，而这些功能都是大同小异，
如果这些功能都要自己去写，将会大大浪费我们的精力降低效率。所以这种重复性的代码可以使用代码生成。</p> <h3 id="默认配置"><a href="#默认配置" class="header-anchor">#</a> 默认配置</h3> <p>单应用在<code>resources</code>目录下的<code>application.yml</code>，多模块<code>ruoyi-generator</code>中的<code>resources</code>目录下的<code>generator.yml</code>，可以自己根据实际情况调整默认配置。</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token comment"># 代码生成</span>
<span class="token key atrule">gen</span><span class="token punctuation">:</span> 
  <span class="token comment"># 开发者姓名，生成到类注释上</span>
  <span class="token key atrule">author</span><span class="token punctuation">:</span> ruoyi
  <span class="token comment"># 默认生成包路径 system 需改成自己的模块名称 如 system monitor tool</span>
  <span class="token key atrule">packageName</span><span class="token punctuation">:</span> com.ruoyi.system
  <span class="token comment"># 自动去除表前缀，默认是false</span>
  <span class="token key atrule">autoRemovePre</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token comment"># 表前缀（生成类名不会包含表前缀，多个用逗号分隔）</span>
  <span class="token key atrule">tablePrefix</span><span class="token punctuation">:</span> sys_
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="单表结构"><a href="#单表结构" class="header-anchor">#</a> 单表结构</h3> <p><strong>新建数据库表结构（单表）</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> sys_student<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> sys_student <span class="token punctuation">(</span>
  student_id           <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>         <span class="token keyword">auto_increment</span>    <span class="token keyword">comment</span> <span class="token string">'编号'</span><span class="token punctuation">,</span>
  student_name         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>        <span class="token keyword">comment</span> <span class="token string">'学生名称'</span><span class="token punctuation">,</span>
  student_age          <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>          <span class="token keyword">default</span> <span class="token boolean">null</span>      <span class="token keyword">comment</span> <span class="token string">'年龄'</span><span class="token punctuation">,</span>
  student_hobby        <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>        <span class="token keyword">comment</span> <span class="token string">'爱好（0代码 1音乐 2电影）'</span><span class="token punctuation">,</span>
  student_sex          <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>         <span class="token keyword">default</span> <span class="token string">'0'</span>       <span class="token keyword">comment</span> <span class="token string">'性别（0男 1女 2未知）'</span><span class="token punctuation">,</span>
  student_status       <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>         <span class="token keyword">default</span> <span class="token string">'0'</span>       <span class="token keyword">comment</span> <span class="token string">'状态（0正常 1停用）'</span><span class="token punctuation">,</span>
  student_birthday     <span class="token keyword">datetime</span>                          <span class="token keyword">comment</span> <span class="token string">'生日'</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>student_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span> <span class="token keyword">auto_increment</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">comment</span> <span class="token operator">=</span> <span class="token string">'学生信息表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="树表结构"><a href="#树表结构" class="header-anchor">#</a> 树表结构</h3> <p><strong>新建数据库表结构（树表）</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> sys_product<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> sys_product <span class="token punctuation">(</span>
  product_id        <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span>    <span class="token keyword">comment</span> <span class="token string">'产品id'</span><span class="token punctuation">,</span>
  parent_id         <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token keyword">default</span> <span class="token number">0</span>                  <span class="token keyword">comment</span> <span class="token string">'父产品id'</span><span class="token punctuation">,</span>
  product_name      <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>                 <span class="token keyword">comment</span> <span class="token string">'产品名称'</span><span class="token punctuation">,</span>
  order_num         <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>          <span class="token keyword">default</span> <span class="token number">0</span>                  <span class="token keyword">comment</span> <span class="token string">'显示顺序'</span><span class="token punctuation">,</span>
  <span class="token keyword">status</span>            <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>         <span class="token keyword">default</span> <span class="token string">'0'</span>                <span class="token keyword">comment</span> <span class="token string">'产品状态（0正常 1停用）'</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>product_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span> <span class="token keyword">auto_increment</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">comment</span> <span class="token operator">=</span> <span class="token string">'产品表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="主子表结构"><a href="#主子表结构" class="header-anchor">#</a> 主子表结构</h3> <p><strong>新建数据库表结构（主子表）</strong></p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment">-- ----------------------------</span>
<span class="token comment">-- 客户表</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> sys_customer<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> sys_customer <span class="token punctuation">(</span>
  customer_id           <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span>    <span class="token keyword">comment</span> <span class="token string">'客户id'</span><span class="token punctuation">,</span>
  customer_name         <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>                 <span class="token keyword">comment</span> <span class="token string">'客户姓名'</span><span class="token punctuation">,</span>
  phonenumber           <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>                 <span class="token keyword">comment</span> <span class="token string">'手机号码'</span><span class="token punctuation">,</span>
  sex                   <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token boolean">null</span>               <span class="token keyword">comment</span> <span class="token string">'客户性别'</span><span class="token punctuation">,</span>
  birthday              <span class="token keyword">datetime</span>                                   <span class="token keyword">comment</span> <span class="token string">'客户生日'</span><span class="token punctuation">,</span>
  remark                <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span>    <span class="token keyword">default</span> <span class="token boolean">null</span>               <span class="token keyword">comment</span> <span class="token string">'客户描述'</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>customer_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span> <span class="token keyword">auto_increment</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">comment</span> <span class="token operator">=</span> <span class="token string">'客户表'</span><span class="token punctuation">;</span>


<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- 商品表</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">drop</span> <span class="token keyword">table</span> <span class="token keyword">if</span> <span class="token keyword">exists</span> sys_goods<span class="token punctuation">;</span>
<span class="token keyword">create</span> <span class="token keyword">table</span> sys_goods <span class="token punctuation">(</span>
  goods_id           <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">not</span> <span class="token boolean">null</span> <span class="token keyword">auto_increment</span>    <span class="token keyword">comment</span> <span class="token string">'商品id'</span><span class="token punctuation">,</span>
  customer_id        <span class="token keyword">bigint</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>      <span class="token operator">not</span> <span class="token boolean">null</span>                   <span class="token keyword">comment</span> <span class="token string">'客户id'</span><span class="token punctuation">,</span>
  name               <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span>     <span class="token keyword">default</span> <span class="token string">''</span>                 <span class="token keyword">comment</span> <span class="token string">'商品名称'</span><span class="token punctuation">,</span>
  weight             <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>          <span class="token keyword">default</span> <span class="token boolean">null</span>               <span class="token keyword">comment</span> <span class="token string">'商品重量'</span><span class="token punctuation">,</span>
  price              <span class="token keyword">decimal</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">default</span> <span class="token boolean">null</span>               <span class="token keyword">comment</span> <span class="token string">'商品价格'</span><span class="token punctuation">,</span>
  <span class="token keyword">date</span>               <span class="token keyword">datetime</span>                                   <span class="token keyword">comment</span> <span class="token string">'商品时间'</span><span class="token punctuation">,</span>
  <span class="token keyword">type</span>               <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>         <span class="token keyword">default</span> <span class="token boolean">null</span>               <span class="token keyword">comment</span> <span class="token string">'商品种类'</span><span class="token punctuation">,</span>
  <span class="token keyword">primary</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>goods_id<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">engine</span><span class="token operator">=</span><span class="token keyword">innodb</span> <span class="token keyword">auto_increment</span><span class="token operator">=</span><span class="token number">1</span> <span class="token keyword">comment</span> <span class="token operator">=</span> <span class="token string">'商品表'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="代码生成使用"><a href="#代码生成使用" class="header-anchor">#</a> 代码生成使用</h3> <p>1、登录系统（系统工具 -&gt; 代码生成 -&gt; 导入对应表）</p> <p>2、代码生成列表中找到需要表（可预览、编辑、同步、删除生成配置）</p> <p>3、点击生成代码会得到一个<code>ruoyi.zip</code>执行<code>sql</code>文件，按照包内目录结构复制到自己的项目中即可</p> <div class="custom-block tip"><p class="custom-block-title">代码生成支持编辑、预览、同步</p> <p>预览：对生成的代码提前预览，防止出现一些不符合预期的情况。</p> <p>同步：对原表的字段进行同步，包括新增、删除、修改的字段处理。</p> <p>修改：对生成的代码基本信息、字段信息、生成信息做一系列的调整。</p> <p>另外多模块所有代码生成的相关业务逻辑代码在<code>ruoyi-generator</code>模块，不需要可以自行删除模块。</p></div> <h2 id="定时任务"><a href="#定时任务" class="header-anchor">#</a> 定时任务</h2> <p>在实际项目开发中Web应用有一类不可缺少的，那就是定时任务。
定时任务的场景可以说非常广泛，比如某些视频网站，购买会员后，每天会给会员送成长值，每月会给会员送一些电影券；
比如在保证最终一致性的场景中，往往利用定时任务调度进行一些比对工作；比如一些定时需要生成的报表、邮件；比如一些需要定时清理数据的任务等。
所以我们提供方便友好的web界面，实现动态管理任务，可以达到动态控制定时任务启动、暂停、重启、删除、添加、修改等操作，极大地方便了开发过程。</p> <div class="custom-block tip"><p class="custom-block-title">提示</p> <p>关于定时任务使用流程</p></div> <p>1、后台添加定时任务处理类（支持<code>Bean</code>调用、<code>Class</code>类调用）<br> <code>Bean</code>调用示例：需要添加对应<code>Bean</code>注解<code>@Component</code>或<code>@Service</code>。调用目标字符串：<code>ryTask.ryParams('ry')</code><br> <code>Class</code>类调用示例：添加类和方法指定包即可。调用目标字符串：<code>com.ruoyi.quartz.task.RyTask.ryParams('ry')</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/**
 * 定时任务调度测试
 * 
 * @author ruoyi
 */</span>
<span class="token annotation punctuation">@Component</span><span class="token punctuation">(</span><span class="token string">&quot;ryTask&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RyTask</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ryMultipleParams</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">,</span> <span class="token class-name">Boolean</span> b<span class="token punctuation">,</span> <span class="token class-name">Long</span> l<span class="token punctuation">,</span> <span class="token class-name">Double</span> d<span class="token punctuation">,</span> <span class="token class-name">Integer</span> i<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;执行多参方法： 字符串类型{}，布尔类型{}，长整型{}，浮点型{}，整形{}&quot;</span><span class="token punctuation">,</span> s<span class="token punctuation">,</span> b<span class="token punctuation">,</span> l<span class="token punctuation">,</span> d<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ryParams</span><span class="token punctuation">(</span><span class="token class-name">String</span> params<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;执行有参方法：&quot;</span> <span class="token operator">+</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ryNoParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;执行无参方法&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>2、前端新建定时任务信息（系统监控 -&gt; 定时任务）<br>
任务名称：自定义，如：定时查询任务状态<br>
任务分组：根据字典<code>sys_job_group</code>配置<br>
调用目标字符串：设置后台任务方法名称参数<br>
执行表达式：可查询官方<code>cron</code>表达式介绍<br>
执行策略：定时任务自定义执行策略<br>
并发执行：是否需要多个任务间同时执行<br>
状态：是否启动定时任务<br>
备注：定时任务描述信息</p> <p>3、点击执行一次，测试定时任务是否正常及调度日志是否正确记录，如正常执行表示任务配置成功。</p> <p>执行策略详解：<br> <code>立即执行</code>（所有<code>misfire</code>的任务会马上执行）打个比方，如果9点<code>misfire</code>了，在10：15系统恢复之后，9点，10点的<code>misfire</code>会马上执行<br> <code>执行一次</code>（会合并部分的<code>misfire</code>，正常执行下一个周期的任务）假设9，10的任务都<code>misfire</code>了，系统在10：15分起来了。只会执行一次<code>misfire</code>，下次正点执行。<br> <code>放弃执行</code>(所有的<code>misfire</code>不管，执行下一个周期的任务)</p> <p>方法参数详解：<br> <code>字符串</code>（需要单引号''标识 如：<code>ryTask.ryParams(’ry’)</code>）<br> <code>布尔类型</code>（需要true false标识 如：<code>ryTask.ryParams(true)</code>）<br> <code>长整型</code>（需要L标识 如：<code>ryTask.ryParams(2000L)</code>）<br> <code>浮点型</code>（需要D标识 如：<code>ryTask.ryParams(316.50D)</code>）<br> <code>整型</code>（纯数字即可）</p> <p>cron表达式语法:<br>
[秒] [分] [小时] [日] [月] [周] [年]</p> <table><thead><tr><th>说明</th> <th>必填</th> <th>允许填写的值</th> <th>允许的通配符</th></tr></thead> <tbody><tr><td>秒</td> <td>是</td> <td>0-59</td> <td>, - * /</td></tr> <tr><td>分</td> <td>是</td> <td>0-59</td> <td>, - * /</td></tr> <tr><td>时</td> <td>是</td> <td>0-23</td> <td>, - * /</td></tr> <tr><td>日</td> <td>是</td> <td>1-31</td> <td>, - * /</td></tr> <tr><td>月</td> <td>是</td> <td>1-12 / JAN-DEC</td> <td>, - * ? / L W</td></tr> <tr><td>周</td> <td>是</td> <td>1-7 or SUN-SAT</td> <td>, - * ? / L #</td></tr> <tr><td>年</td> <td>是</td> <td>1970-2099</td> <td>, - * /</td></tr></tbody></table> <p>通配符说明:<br> <code>*</code> 表示所有值。 例如:在分的字段上设置 *,表示每一分钟都会触发<br> <code>?</code> 表示不指定值。使用的场景为不需要关心当前设置这个字段的值。例如:要在每月的10号触发一个操作，但不关心是周几，所以需要周位置的那个字段设置为”?” 具体设置为 0 0 0 10 * ?<br> <code>-</code> 表示区间。例如 在小时上设置 “10-12”,表示 10,11,12点都会触发<br> <code>,</code> 表示指定多个值，例如在周字段上设置 “MON,WED,FRI” 表示周一，周三和周五触发<br> <code>/</code> 用于递增触发。如在秒上面设置”5/15” 表示从5秒开始，每增15秒触发(5,20,35,50)。 在月字段上设置’1/3’所示每月1号开始，每隔三天触发一次<br> <code>L</code> 表示最后的意思。在日字段设置上，表示当月的最后一天(依据当前月份，如果是二月还会依据是否是润年[leap]), 在周字段上表示星期六，相当于”7”或”SAT”。如果在”L”前加上数字，则表示该数据的最后一个。例如在周字段上设置”6L”这样的格式,则表示“本月最后一个星期五”<br> <code>W</code> 表示离指定日期的最近那个工作日(周一至周五). 例如在日字段上置”15W”，表示离每月15号最近的那个工作日触发。如果15号正好是周六，则找最近的周五(14号)触发, 如果15号是周未，则找最近的下周一(16号)触发.如果15号正好在工作日(周一至周五)，则就在该天触发。如果指定格式为 “1W”,它则表示每月1号往后最近的工作日触发。如果1号正是周六，则将在3号下周一触发。(注，”W”前只能设置具体的数字,不允许区间”-“)<br> <code>#</code> 序号(表示每月的第几个周几)，例如在周字段上设置”6#3”表示在每月的第三个周六.注意如果指定”#5”,正好第五周没有周六，则不会触发该配置(用在母亲节和父亲节再合适不过了) ；小提示：’L’和 ‘W’可以一组合使用。如果在日字段上设置”LW”,则表示在本月的最后一个工作日触发；周字段的设置，若使用英文字母是不区分大小写的，即MON与mon相同</p> <p>常用表达式例子:</p> <table><thead><tr><th>表达式</th> <th>说明</th></tr></thead> <tbody><tr><td>0 0 2 1 * ? *</td> <td>表示在每月的1日的凌晨2点调整任务</td></tr> <tr><td>0 15 10 ? * MON-FRI</td> <td>表示周一到周五每天上午10:15执行作业</td></tr> <tr><td>0 15 10 ? 6L 2002-2006</td> <td>表示2002-2006年的每个月的最后一个星期五上午10:15执行作</td></tr> <tr><td>0 0 10,14,16 * * ?</td> <td>每天上午10点，下午2点，4点</td></tr> <tr><td>0 0/30 9-17 * * ?</td> <td>朝九晚五工作时间内每半小时</td></tr> <tr><td>0 0 12 ? * WED</td> <td>表示每个星期三中午12点</td></tr> <tr><td>0 0 12 * * ?</td> <td>每天中午12点触发</td></tr> <tr><td>0 15 10 ? * *</td> <td>每天上午10:15触发</td></tr> <tr><td>0 15 10 * * ?</td> <td>每天上午10:15触发</td></tr> <tr><td>0 15 10 * * ? *</td> <td>每天上午10:15触发</td></tr> <tr><td>0 15 10 * * ? 2005</td> <td>2005年的每天上午10:15触发</td></tr> <tr><td>0 * 14 * * ?</td> <td>在每天下午2点到下午2:59期间的每1分钟触发</td></tr> <tr><td>0 0/5 14 * * ?</td> <td>在每天下午2点到下午2:55期间的每5分钟触发</td></tr> <tr><td>0 0/5 14,18 * * ?</td> <td>在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发</td></tr> <tr><td>0 0-5 14 * * ?</td> <td>在每天下午2点到下午2:05期间的每1分钟触发</td></tr> <tr><td>0 10,44 14 ? 3 WED</td> <td>每年三月的星期三的下午2:10和2:44触发</td></tr> <tr><td>0 15 10 ? * MON-FRI</td> <td>周一至周五的上午10:15触发</td></tr> <tr><td>0 15 10 15 * ?</td> <td>每月15日上午10:15触发</td></tr> <tr><td>0 15 10 L * ?</td> <td>每月最后一日的上午10:15触发</td></tr> <tr><td>0 15 10 ? * 6L</td> <td>每月的最后一个星期五上午10:15触发</td></tr> <tr><td>0 15 10 ? * 6L 2002-2005</td> <td>2002年至2005年的每月的最后一个星期五上午10:15触发</td></tr> <tr><td>0 15 10 ? * 6#3</td> <td>每月的第三个星期五上午10:15触发</td></tr></tbody></table> <p>多模块所有定时任务的相关业务逻辑代码在<code>ruoyi-quartz</code>模块，可以自行调整或剔除</p> <p><code>注意：不同数据源定时任务都有对应脚本，Oracle、Mysql已经有了，其他的可自行下载执行</code></p> <h2 id="系统接口"><a href="#系统接口" class="header-anchor">#</a> 系统接口</h2> <p>在现在的开发过程中还有很大一部分公司都是以口口相传的方式来进行前后端的联调，而接口文档很大一部分都只停留在了说说而已的地步，或者写了代码再写文档。
还有一点就是文档的修改，定义好的接口并不是一成不变的，可能在开发过程中文档修改不止一次的变化，这个时候就会很难受了。
只要不是强制性要求，没人会愿意写这东西，而且在写的过程中，一个字母的错误就会导致联调时候的很大麻烦，但是通过<code>Swagger</code>，我们可以省略了这一步，而且文档出错率近乎于零，
只要你在写代码的时候，稍加几个注解，文档自动生成。</p> <p>1、在控制层<code>Controller</code>中添加注解来描述接口信息如:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span><span class="token string">&quot;参数配置&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/system/config&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigController</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>2、在方法中配置接口的标题信息</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token variable">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;查询参数列表&quot;</span><span class="token punctuation">)</span>
<span class="token variable">@ResponseBody</span>
<span class="token keyword">public</span> TableDataInfo list<span class="token punctuation">(</span>Config config<span class="token punctuation">)</span>
{
	startPage<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	List<span class="token operator">&lt;</span>Config<span class="token operator">&gt;</span> list <span class="token operator">=</span> configService<span class="token punctuation">.</span>selectConfigList<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> getDataTable<span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>3、在<code>系统工具-系统接口</code>测试相关接口</p> <p><code>注意：SwaggerConfig可以指定根据注解或者包名扫描具体的API</code></p> <p>API详细说明</p> <table><thead><tr><th>作用范围</th> <th>API</th> <th>使用位置</th></tr></thead> <tbody><tr><td>协议集描述</td> <td>@Api</td> <td>用于controller类上</td></tr> <tr><td>对象属性</td> <td>@ApiModelProperty</td> <td>用在出入参数对象的字段上</td></tr> <tr><td>协议描述</td> <td>@ApiOperation</td> <td>用在controller的方法上</td></tr> <tr><td>Response集</td> <td>@ApiResponses</td> <td>用在controller的方法上</td></tr> <tr><td>Response</td> <td>@ApiResponse</td> <td>用在 @ApiResponses里边</td></tr> <tr><td>非对象参数集</td> <td>@ApiImplicitParams</td> <td>用在controller的方法上</td></tr> <tr><td>非对象参数描述</td> <td>@ApiImplicitParam</td> <td>用在@ApiImplicitParams的方法里边</td></tr> <tr><td>描述返回对象的意义</td> <td>@ApiModel</td> <td>用在返回对象类上</td></tr></tbody></table> <p><code>api</code>标记，用在类上，说明该类的作用。可以标记一个<code>Controller</code>类做为<code>Swagger</code>文档资源，使用方式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Api</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/user&quot;</span><span class="token punctuation">,</span> description <span class="token operator">=</span> <span class="token string">&quot;用户管理&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与<code>Controller</code>注解并列使用。 属性配置：</p> <table><thead><tr><th>属性名称</th> <th>备注</th></tr></thead> <tbody><tr><td>value</td> <td>url的路径值</td></tr> <tr><td>tags</td> <td>如果设置这个值、value的值会被覆盖</td></tr> <tr><td>description</td> <td>对api资源的描述</td></tr> <tr><td>basePath</td> <td>基本路径可以不配置</td></tr> <tr><td>position</td> <td>如果配置多个Api 想改变显示的顺序位置</td></tr> <tr><td>produces</td> <td>For example, &quot;application/json, application/xml&quot;</td></tr> <tr><td>consumes</td> <td>For example, &quot;application/json, application/xml&quot;</td></tr> <tr><td>protocols</td> <td>Possible values: http, https, ws, wss.</td></tr> <tr><td>authorizations</td> <td>高级特性认证时配置</td></tr> <tr><td>hidden</td> <td>配置为true 将在文档中隐藏</td></tr></tbody></table> <p><code>ApiOperation</code>标记，用在方法上，说明方法的作用，每一个<code>url</code>资源的定义,使用方式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span><span class="token string">&quot;获取用户信息&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与<code>Controller</code>中的方法并列使用，属性配置：</p> <table><thead><tr><th>属性名称</th> <th>备注</th></tr></thead> <tbody><tr><td>value</td> <td>url的路径值</td></tr> <tr><td>tags</td> <td>如果设置这个值、value的值会被覆盖</td></tr> <tr><td>description</td> <td>对api资源的描述</td></tr> <tr><td>basePath</td> <td>基本路径可以不配置</td></tr> <tr><td>position</td> <td>如果配置多个Api 想改变显示的顺序位置</td></tr> <tr><td>produces</td> <td>For example, &quot;application/json, application/xml&quot;</td></tr> <tr><td>consumes</td> <td>For example, &quot;application/json, application/xml&quot;</td></tr> <tr><td>protocols</td> <td>Possible values: http, https, ws, wss.</td></tr> <tr><td>authorizations</td> <td>高级特性认证时配置</td></tr> <tr><td>hidden</td> <td>配置为true将在文档中隐藏</td></tr> <tr><td>response</td> <td>返回的对象</td></tr> <tr><td>responseContainer</td> <td>这些对象是有效的 &quot;List&quot;, &quot;Set&quot; or &quot;Map&quot;.，其他无效</td></tr> <tr><td>httpMethod</td> <td>&quot;GET&quot;, &quot;HEAD&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot; and &quot;PATCH&quot;</td></tr> <tr><td>code</td> <td>http的状态码 默认 200</td></tr> <tr><td>extensions</td> <td>扩展属性</td></tr></tbody></table> <p><code>ApiParam</code>标记，请求属性，使用方式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">TableDataInfo</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token annotation punctuation">@ApiParam</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;查询用户列表&quot;</span><span class="token punctuation">,</span> required <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token class-name">User</span> user<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与Controller中的方法并列使用，属性配置：</p> <table><thead><tr><th>属性名称</th> <th>备注</th></tr></thead> <tbody><tr><td>name</td> <td>属性名称</td></tr> <tr><td>value</td> <td>属性值</td></tr> <tr><td>defaultValue</td> <td>默认属性值</td></tr> <tr><td>allowableValues</td> <td>可以不配置</td></tr> <tr><td>required</td> <td>是否属性必填</td></tr> <tr><td>access</td> <td>不过多描述</td></tr> <tr><td>allowMultiple</td> <td>默认为false</td></tr> <tr><td>hidden</td> <td>隐藏该属性</td></tr> <tr><td>example</td> <td>举例子</td></tr></tbody></table> <p><code>ApiResponse</code>标记，响应配置，使用方式：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ApiResponse</span><span class="token punctuation">(</span>code <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;查询用户失败&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与<code>Controller</code>中的方法并列使用，属性配置：</p> <table><thead><tr><th>属性名称</th> <th>备注</th></tr></thead> <tbody><tr><td>code</td> <td>http的状态码</td></tr> <tr><td>message</td> <td>描述</td></tr> <tr><td>response</td> <td>默认响应类 Void</td></tr> <tr><td>reference</td> <td>参考ApiOperation中配置</td></tr> <tr><td>responseHeaders</td> <td>参考 ResponseHeader 属性配置说明</td></tr> <tr><td>responseContainer</td> <td>参考ApiOperation中配置</td></tr></tbody></table> <p><code>ApiResponses</code>标记，响应集配置，使用方式:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ApiResponses</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token annotation punctuation">@ApiResponse</span><span class="token punctuation">(</span>code <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;无效的用户&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与<code>Controller</code>中的方法并列使用，属性配置：</p> <table><thead><tr><th>属性名称</th> <th>备注</th></tr></thead> <tbody><tr><td>value</td> <td>多个ApiResponse配置</td></tr></tbody></table> <p><code>ResponseHeader</code>标记，响应头设置，使用方法</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@ResponseHeader</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;head&quot;</span><span class="token punctuation">,</span>description<span class="token operator">=</span><span class="token string">&quot;响应头设计&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>与<code>Controller</code>中的方法并列使用，属性配置：</p> <table><thead><tr><th>属性名称</th> <th>备注</th></tr></thead> <tbody><tr><td>name</td> <td>响应头名称</td></tr> <tr><td>description</td> <td>描述</td></tr> <tr><td>response</td> <td>默认响应类 void</td></tr> <tr><td>responseContainer</td> <td>参考ApiOperation中配置</td></tr></tbody></table> <h2 id="防重复提交"><a href="#防重复提交" class="header-anchor">#</a> 防重复提交</h2> <p>在接口方法上添加<code>@RepeatSubmit</code>注解即可，注解参数说明：</p> <table><thead><tr><th>参数</th> <th>类型</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>interval</td> <td>int</td> <td>5000</td> <td>间隔时间(ms)，小于此时间视为重复提交</td></tr> <tr><td>message</td> <td>String</td> <td>不允许重复提交，请稍后再试</td> <td>提示消息</td></tr></tbody></table> <p><strong>示例1：采用默认参数</strong></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RepeatSubmit</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">addSave</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>示例2：指定防重复时间和错误消息</strong></p> <div class="language-java line-numbers-mode"><div class="highlight-lines"><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@RepeatSubmit</span><span class="token punctuation">(</span>interval <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;请求过于频繁&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">AjaxResult</span> <span class="token function">addSave</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="国际化支持"><a href="#国际化支持" class="header-anchor">#</a> 国际化支持</h2> <p>在我们开发WEB项目的时候，项目可能涉及到在国外部署或者应用，也有可能会有国外的用户对项目进行访问，那么在这种项目中，
为客户展现的页面或者操作的信息就需要使用不同的语言，这就是我们所说的项目国际化。
目前项目已经支持多语言国际化，接下来我们介绍如何使用。</p> <h3 id="后台国际化流程"><a href="#后台国际化流程" class="header-anchor">#</a> 后台国际化流程</h3> <p>1、修改<code>I18nConfig</code>设置默认语言，如默认<code>中文</code>：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 默认语言，英文可以设置Locale.US</span>
slr<span class="token punctuation">.</span><span class="token function">setDefaultLocale</span><span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">.</span><span class="token constant">SIMPLIFIED_CHINESE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>2、修改配置<code>application.yml</code>中的<code>basename</code>国际化文件，默认是<code>i18n</code>路径下<code>messages</code>文件<br>
（比如现在国际化文件是<code>xx_zh_CN.properties</code>、<code>xx_en_US.properties</code>，那么<code>basename</code>配置应为是<code>i18n/xx</code></p> <div class="language-yml line-numbers-mode"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br></div><pre class="language-yml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token comment"># 资源信息</span>
  <span class="token key atrule">messages</span><span class="token punctuation">:</span>
    <span class="token comment"># 国际化资源文件路径</span>
    <span class="token key atrule">basename</span><span class="token punctuation">:</span> static/i18n/messages
</code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>3、<code>i18n</code>目录文件下定义资源文件<br>
美式英语 <code>messages_en_US.properties</code></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">user.login.username</span><span class="token punctuation">=</span><span class="token value attr-value">User name</span>
<span class="token key attr-name">user.login.password</span><span class="token punctuation">=</span><span class="token value attr-value">Password</span>
<span class="token key attr-name">user.login.code</span><span class="token punctuation">=</span><span class="token value attr-value">Security code</span>
<span class="token key attr-name">user.login.remember</span><span class="token punctuation">=</span><span class="token value attr-value">Remember me</span>
<span class="token key attr-name">user.login.submit</span><span class="token punctuation">=</span><span class="token value attr-value">Sign In</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>中文简体 <code>messages_zh_CN.properties</code></p> <div class="language-properties line-numbers-mode"><pre class="language-properties"><code><span class="token key attr-name">user.login.username</span><span class="token punctuation">=</span><span class="token value attr-value">用户名</span>
<span class="token key attr-name">user.login.password</span><span class="token punctuation">=</span><span class="token value attr-value">密码</span>
<span class="token key attr-name">user.login.code</span><span class="token punctuation">=</span><span class="token value attr-value">验证码</span>
<span class="token key attr-name">user.login.remember</span><span class="token punctuation">=</span><span class="token value attr-value">记住我</span>
<span class="token key attr-name">user.login.submit</span><span class="token punctuation">=</span><span class="token value attr-value">登录</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>4、java代码使用<code>MessageUtils</code>获取国际化</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">MessageUtils</span><span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;user.login.username&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">MessageUtils</span><span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;user.login.password&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">MessageUtils</span><span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;user.login.code&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">MessageUtils</span><span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;user.login.remember&quot;</span><span class="token punctuation">)</span>
<span class="token class-name">MessageUtils</span><span class="token punctuation">.</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token string">&quot;user.login.submit&quot;</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="前端国际化流程"><a href="#前端国际化流程" class="header-anchor">#</a> 前端国际化流程</h3> <p>1、html使用国际化#{资源文件key}</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>signupForm<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h4</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>no-margins<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h4</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>m-t-md<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>你若不离不弃，我必生死相依<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>     <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>username<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control uname<span class="token punctuation">&quot;</span></span>  <span class="token attr-name"><span class="token namespace">th:</span>placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#{user.login.username}<span class="token punctuation">&quot;</span></span>   <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>password<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control pword<span class="token punctuation">&quot;</span></span>  <span class="token attr-name"><span class="token namespace">th:</span>placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#{user.login.password}<span class="token punctuation">&quot;</span></span>   <span class="token punctuation">/&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>row m-t<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${captchaEnabled==true}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-xs-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>validateCode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>form-control code<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#{user.login.code}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">maxlength</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autocomplete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>off<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>col-xs-6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>javascript:void(0);<span class="token punctuation">&quot;</span></span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>点击更换验证码<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
				<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name"><span class="token namespace">th:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@{captcha/captchaImage(type=${captchaType})}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>imgcode<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>85%<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox-custom<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>classappend</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${captchaEnabled==false} ? 'm-t'<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>checkbox<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rememberme<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rememberme<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rememberme<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#{user.login.remember}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>记住我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn btn-success btn-block<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnSubmit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>正在验证登录，请稍后...<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#{user.login.submit}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>登录<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>2、js使用国际化
首先在文件引入<code>jquery-i18n-properties</code>依赖，然后在初始化后即可通过JS函数获取对应国际化文件的内容。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>jQuery国际化插件<span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;../static/js/jquery.i18n.properties.min.js&quot;</span> <span class="token literal-property property">th</span><span class="token operator">:</span>src<span class="token operator">=</span><span class="token string">&quot;@{/js/jquery.i18n.properties.min.js}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script th<span class="token operator">:</span>inline<span class="token operator">=</span><span class="token string">&quot;javascript&quot;</span><span class="token operator">&gt;</span>
	<span class="token comment">//获取应用路径</span>
	<span class="token keyword">var</span> <span class="token constant">ROOT</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>$<span class="token punctuation">{</span>#servletContext<span class="token punctuation">.</span>contextPath<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">//获取默认语言</span>
	<span class="token keyword">var</span> <span class="token constant">LANG_COUNTRY</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>$<span class="token punctuation">{</span>#locale<span class="token punctuation">.</span>language<span class="token operator">+</span><span class="token string">'_'</span><span class="token operator">+</span>#locale<span class="token punctuation">.</span>country<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

	<span class="token comment">//初始化i18n插件</span>
	$<span class="token punctuation">.</span>i18n<span class="token punctuation">.</span><span class="token function">properties</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
		<span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token constant">ROOT</span> <span class="token operator">+</span> <span class="token string">'/i18n/'</span><span class="token punctuation">,</span><span class="token comment">//这里表示访问路径</span>
		<span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'messages'</span><span class="token punctuation">,</span><span class="token comment">//文件名开头</span>
		<span class="token literal-property property">language</span><span class="token operator">:</span> <span class="token constant">LANG_COUNTRY</span><span class="token punctuation">,</span><span class="token comment">//文件名语言 例如en_US</span>
		<span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">'map'</span><span class="token comment">//默认值</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">//初始化i18n函数</span>
	<span class="token keyword">function</span> <span class="token function">i18n</span><span class="token punctuation">(</span><span class="token parameter">msgKey</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">try</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> $<span class="token punctuation">.</span>i18n<span class="token punctuation">.</span><span class="token function">prop</span><span class="token punctuation">(</span>msgKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> msgKey<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>

	<span class="token comment">//获取国际化翻译值</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">i18n</span><span class="token punctuation">(</span><span class="token string">'user.login.username'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">i18n</span><span class="token punctuation">(</span><span class="token string">'user.login.password'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">i18n</span><span class="token punctuation">(</span><span class="token string">'user.login.code'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">i18n</span><span class="token punctuation">(</span><span class="token string">'user.login.remember'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">i18n</span><span class="token punctuation">(</span><span class="token string">'user.login.submit'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>3、界面定义切换语言</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>?lang=en_US<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 英语 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>?lang=zh_CN<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 中文 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>  
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="新建子模块"><a href="#新建子模块" class="header-anchor">#</a> 新建子模块</h2> <p><code>Maven</code>多模块下新建子模块流程案例。</p> <p>1、新建业务模块目录，例如：<code>ruoyi-test</code>。</p> <p>2、在<code>ruoyi-test</code>业务模块下新建<code>pom.xml</code>文件以及<code>src\main\java</code>，<code>src\main\resources</code>目录。</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">&quot;</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ruoyi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.ruoyi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>x.x.x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">&gt;</span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ruoyi-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>
        test系统模块
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- 通用工具--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.ruoyi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ruoyi-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>3、根目录<code>pom.xml</code>依赖声明节点<code>dependencies</code>中添加依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 测试模块--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.ruoyi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ruoyi-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${ruoyi.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>4、根目录<code>pom.xml</code>模块节点<code>modules</code>添加业务模块</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>ruoyi-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>5、<code>ruoyi-admin</code>目录<code>pom.xml</code>添加模块依赖</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 测试模块--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.ruoyi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>ruoyi-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>6、测试模块</p> <p>在<code>ruoyi-test</code>业务模块添加<code>com.ruoyi.test</code>包，新建<code>TestService.java</code></p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestService</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">helloTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>在<code>ruoyi-admin</code>新建测试类，调用<code>helloTest</code>成功返回<code>hello</code>代表成功。</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ruoyi/document/xmjs.html" class="prev">
        项目介绍
      </a></span> <span class="next"><a href="/ruoyi/document/qdsc.html">
        前端手册
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c3abf7ee.js" defer></script><script src="/assets/js/2.f516d180.js" defer></script><script src="/assets/js/51.8c138180.js" defer></script>
  </body>
</html>
